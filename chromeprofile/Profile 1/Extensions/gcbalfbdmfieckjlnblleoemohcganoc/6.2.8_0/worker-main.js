!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=2)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.HeapMemory=class{constructor(e){const t="BYTES_PER_ELEMENT"in e?e:new Uint8Array(e),r=t.length*t.BYTES_PER_ELEMENT,n=Module._malloc(r);this.heapBytes=Module.HEAPU8.subarray(n,n+r),this.heapBytes.set(t)}free(){Module._free(this.heapBytes.byteOffset)}get offset(){return this.heapBytes.byteOffset}get length(){return this.heapBytes.length}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class n{static create(e,t){return{id:n.nextId++,type:e,startTime:performance.now(),finishTime:0,args:t,result:void 0}}static complete(e,t){return{id:e.id,type:e.type,startTime:e.startTime,finishTime:performance.now(),args:e.args,result:t}}}n.nextId=1,t.JobFactory=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(1),a=r(0);self.onmessage=function(e){const t=e.data;switch(t.type){case 1:const e=t.data;let r;switch(e.type){case 0:r=function(e){let t;const r=new a.HeapMemory(e);try{t=kantusearch.readImageInfo(r.offset,r.length)}finally{r.free()}return t}(e.args.image);break;case 1:{const t=e.args;r=function(e,t,r){const n=new kantusearch.Image(e.width,e.height);n.data.set(e.data);const a=kantusearch.resizeImage(n,t,r),o=new Uint8ClampedArray(a.data);return new ImageData(o,a.width,a.height)}(t.image,t.scaleX,t.scaleY);break}case 2:{const t=e.args;r=function(e,t,r){const n=new kantusearch.Image(e.width,e.height);n.data.set(e.data);const a=new kantusearch.Image(t.width,t.height);a.data.set(t.data);const o=kantusearch.searchImage(n,a,r);return n.delete(),a.delete(),o}(t.image,t.pattern,t.options);break}case 3:{const t=e.args;r=function(e,t,r){const n=new kantusearch.Image(e.width,e.height);n.data.set(e.data);const a=kantusearch.searchRect(n,t,r);return n.delete(),a}(t.image,t.color,t.distanceThreshold);break}default:throw Error(`Unsupported job type: ${e.type}`)}const o={type:1,data:n.JobFactory.complete(e,r)};self.postMessage(o);break;default:throw Error(`Unsupported message type: ${t.type}`)}},self.onerror=function(e){console.error("Worker.onerror:",e)}}]);
//# sourceMappingURL=worker-main.js.map