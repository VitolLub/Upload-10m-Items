var ScrapeChromeDriver;
(function (ScrapeChromeDriver) {
    ScrapeChromeDriver.ExtensionNamespace = typeof browser != 'undefined' ? browser : chrome;
    ScrapeChromeDriver.library = new ScrapeLibrary.Scraper(document);
    function getTime() {
        return (window.performance) ? window.performance.now() : Date.now();
    }
    ScrapeChromeDriver.getTime = getTime;
    function createNewResponse(messageId) {
        return {
            msgId: messageId,
            error: undefined,
            payload: undefined,
            performanceTiming: {
                requestStart: undefined,
                requestEnd: undefined
            }
        };
    }
    function handleMessage(request, sender, sendResponse) {
        if (request && this.library.canHandle(request.type)) {
            var response = createNewResponse(request.msgId);
            try {
                response.performanceTiming.requestStart = this.getTime();
                response.payload = this.library.handle(request.type, request.payload);
                response.performanceTiming.requestEnd = this.getTime();
            }
            catch (e) {
                response.error = (e && typeof e.toString === "function") ? e.toString() : "Error object in ScrapeChromeDriver is undefined or has no toString method";
            }
            finally {
                sendResponse(response);
            }
        }
    }
    ScrapeChromeDriver.handleMessage = handleMessage;
    function bootstrap() {
        if (!this.initialized) {
            this.initialized = true;
            ScrapeChromeDriver.ExtensionNamespace.runtime.onMessage.addListener(this.handleMessage.bind(this));
        }
    }
    ScrapeChromeDriver.bootstrap = bootstrap;
    ScrapeChromeDriver.bootstrap.call(ScrapeChromeDriver);
})(ScrapeChromeDriver || (ScrapeChromeDriver = {}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU2NyYXBlRHJpdmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vLi4vc3JjL3VicC9leHRlbnNpb24vY29udGV4dHVhbC9wZWVyLXNjcmlwdHMvZHJpdmVycy9jaHJvbWUvU2NyYXBlRHJpdmVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQVdBLElBQVUsa0JBQWtCLENBd0gzQjtBQXhIRCxXQUFVLGtCQUFrQjtJQVNiLHFDQUFrQixHQUFRLE9BQU8sT0FBTyxJQUFJLFdBQVcsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFpQjNFLDBCQUFPLEdBQTBCLElBQUksYUFBYSxDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsQ0FBQztJQVdoRixTQUFnQixPQUFPO1FBQ25CLE9BQU8sQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUN4RSxDQUFDO0lBRmUsMEJBQU8sVUFFdEIsQ0FBQTtJQVlELFNBQVMsaUJBQWlCLENBQUMsU0FBZ0I7UUFDdkMsT0FBTztZQUNILEtBQUssRUFBUSxTQUFTO1lBQ3RCLEtBQUssRUFBUSxTQUFTO1lBQ3RCLE9BQU8sRUFBTSxTQUFTO1lBQ3RCLGlCQUFpQixFQUFFO2dCQUNmLFlBQVksRUFBRSxTQUFTO2dCQUN2QixVQUFVLEVBQUksU0FBUzthQUMxQjtTQUNKLENBQUM7SUFDTixDQUFDO0lBZUQsU0FBZ0IsYUFBYSxDQUFDLE9BQThCLEVBQzlCLE1BQW1DLEVBQ25DLFlBQXVEO1FBQ2pGLElBQUksT0FBTyxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsRUFBRTtZQUVqRCxJQUFJLFFBQVEsR0FBMkIsaUJBQWlCLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRXhFLElBQUk7Z0JBQ0EsUUFBUSxDQUFDLGlCQUFpQixDQUFDLFlBQVksR0FBRyxJQUFJLENBQUMsT0FBTyxFQUFFLENBQUM7Z0JBSXpELFFBQVEsQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksRUFBRSxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBRXRFLFFBQVEsQ0FBQyxpQkFBaUIsQ0FBQyxVQUFVLEdBQUcsSUFBSSxDQUFDLE9BQU8sRUFBRSxDQUFDO2FBQzFEO1lBQ0QsT0FBTSxDQUFDLEVBQUU7Z0JBR0wsUUFBUSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsSUFBSSxPQUFPLENBQUMsQ0FBQyxRQUFRLEtBQUssVUFBVSxDQUFDLENBQUEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxRQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsMkVBQTJFLENBQUM7YUFDeEo7b0JBQ087Z0JBQ0osWUFBWSxDQUFDLFFBQVEsQ0FBQyxDQUFDO2FBQzFCO1NBQ0o7SUFDTCxDQUFDO0lBekJlLGdDQUFhLGdCQXlCNUIsQ0FBQTtJQVFELFNBQWdCLFNBQVM7UUFFckIsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLEVBQUU7WUFDbkIsSUFBSSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7WUFFeEIsbUJBQUEsa0JBQWtCLENBQUMsT0FBTyxDQUFDLFNBQVMsQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztTQUNuRjtJQUNMLENBQUM7SUFQZSw0QkFBUyxZQU94QixDQUFBO0lBR0Qsa0JBQWtCLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDO0FBQzFELENBQUMsRUF4SFMsa0JBQWtCLEtBQWxCLGtCQUFrQixRQXdIM0IiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIFRoaXMgYm9vdHN0cmFwcyB7QGxpbmsgU2NyYXBlTGlicmFyeX0gdW5kZXIgQ2hyb21lJ3MgY29udGVudCBzY3JpcHRcbiAqIGVudmlyb25tZW50IG9ubHkgT05DRTogVG8gYXZvaWQgZHVwbGljYXRlIGxpc3RlbmVycyBvbiBjaHJvbWUgcnVudGltZVxuICogbWVzc2FnZXMsIHtAbGluayBTY3JhcGVDaHJvbWVEcml2ZXIjYm9vdHN0cmFwfSB3aWxsIG9ubHkgcmVnaXN0ZXIgdGhlIGxpc3RlbmVyIG9uY2VcbiAqIHdpdGhpbiB0aGUgY29udGVudCBzY3JpcHQgSlJFIGxpZmV0aW1lIGJ5IGlnbm9yaW5nIGFsbCBzdWJzZXF1ZW50IGNhbGxzLlxuICogSG93ZXZlciwge0BsaW5rIFNjcmFwZUxpYnJhcnl9IHdpbGwgYmUgcmVuZXdlZCBpZiBpbmplY3RlZCBhZ2FpblxuICogdG8gZW5zdXJlIHRoZSBsaWJyYXJ5IGlzIHVwIHRvIGRhdGUgaW4gY2FzZSBvZiBleHRlbnNpb24gdXBkYXRlcy9yZXN0YXJ0cy5cbiAqXG4gKiBYWFg6IHBlZXIgc2NyaXB0cyBjYW5ub3QgdXNlIHRoZSBtb2R1bGUgbG9hZGVyIGFzIHRoZXkgYXJlIHRvIGJlIGluamVjdGVkXG4gKiBvbnRvIHRoZSBwYWdlIGRpcmVjdGx5IGFuZCB0aHVzIG5lZWQgdG8gbGlnaHQtd2VpZ2h0LlxuICovXG5uYW1lc3BhY2UgU2NyYXBlQ2hyb21lRHJpdmVyIHtcblxuICAgIC8qKlxuICAgICAqIEdldCB0aGUgcnVudGltZSBleHRlbnNpb24gbmFtZXNwYWNlLCB3aGljaCBpcyB0aGUgZXh0ZW5zaW9uIEFwaSBuYW1lc3BhY2VcbiAgICAgKiBmb3IgY2hyb21lLCBpdCBpcyBjaHJvbWVcbiAgICAgKiBmb3IgZWRnZSwgaXQgaXMgZWRnZVxuICAgICAqIEl0IHdpbGwgYmUgaWRlYWwgd2UgY2FuIGdldCB0aGlzIGZyb20gUnVudGltbWVcbiAgICAgKiBAdHlwZSB7YnJvd3NlcnxjaHJvbWV9XG4gICAgICovXG4gICAgZXhwb3J0IHZhciBFeHRlbnNpb25OYW1lc3BhY2U6IGFueSA9IHR5cGVvZiBicm93c2VyICE9ICd1bmRlZmluZWQnID8gYnJvd3NlciA6IGNocm9tZTtcbiAgICBcbiAgICAvKipcbiAgICAgKiBHbG9iYWwgRmxhZyB0byBlbnN1cmUgYm9vdHN0cmFwcGluZyBvbmx5IGhhcHBlbnMgb25jZS5cbiAgICAgKlxuICAgICAqIFhYWDogVHlwZXNjcmlwdCBjb21waWxlciB0cmFuc2xhdGVzIHRoaXMgbGluZSBpbnRvXG4gICAgICogXCJTY3JhcGVDaHJvbWVEcml2ZXIuaW5pdGlhbGl6ZWQ7XCIsIHdoaWNoIGhhcyBubyBlZmZlY3RcbiAgICAgKiB0byBpdHMgc3RhdGUgd2hldGhlciBpZiBpdCBleGlzdHMgYWxyZWFkeVxuICAgICAqL1xuICAgIGV4cG9ydCB2YXIgaW5pdGlhbGl6ZWQ6Ym9vbGVhbjtcblxuICAgIC8qKlxuICAgICAqIERlbGVnYXRlIHRvIHRoZSBicm93c2VyLWFnbm9zdGljIGNvbnRleHR1YWwgcGVlciBsaWJyYXJ5IGZvciBzY3JhcGluZy5cbiAgICAgKiBOb3RlOiBTY3JhcGVDaHJvbWVEcml2ZXIgaXMgYSBnbG9iYWwgbmFtZXNwYWNlIGFuZCB0aGlzIHdpbGwgcmVwbGFjZSBpdHNcbiAgICAgKiByZWZlcmVuY2UgZXZlcnkgdGltZSB0aGUgZHJpdmVyIHNjcmlwdCBpcyBpbmplY3RlZFxuICAgICAqIEB0eXBlIHtTY3JhcGVMaWJyYXJ5LlNjcmFwZXJ9XG4gICAgICovXG4gICAgZXhwb3J0IHZhciBsaWJyYXJ5OklDb250ZXh0dWFsUGVlckxpYnJhcnkgPSBuZXcgU2NyYXBlTGlicmFyeS5TY3JhcGVyKGRvY3VtZW50KTtcblxuICAgIC8qKlxuICAgICAqIFJldHVybiBjdXJyZW50IHRpbWUgc3RhbXAgZm9yIHByb2ZpbGluZ1xuICAgICAqXG4gICAgICogcGVyZm9ybWFuY2Uubm93KCkgcmV0dXJucyBhIGhpZ2ggcmVzb2x1dGlvbiB0aW1lIHN0YW1wIGluIG1pbGxpb25cbiAgICAgKiBzZWNvbmRzLiBVbmxpa2UgRGF0ZS5ub3coKSwgaXQgcmV0dXJucyBhIGZsb2F0aW5nIHBvaW50IG51bWJlciB3aXRoIHVwXG4gICAgICogdG8gbWljcm9zZWNvbmQgcHJlY2lzaW9uLlxuICAgICAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9QZXJmb3JtYW5jZS5ub3dcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICAqL1xuICAgIGV4cG9ydCBmdW5jdGlvbiBnZXRUaW1lKCkge1xuICAgICAgICByZXR1cm4gKHdpbmRvdy5wZXJmb3JtYW5jZSkgPyB3aW5kb3cucGVyZm9ybWFuY2Uubm93KCkgOiBEYXRlLm5vdygpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJ1aWxkIGFuZCByZXR1cm4gYW4gZW1wdHkge0BsaW5rIElDb250ZXh0dWFsUGVlclJlc3BvbnNlfSBvYmplY3RcbiAgICAgKlxuICAgICAqIE5vdGU6IHBlcmZvcm1hbmNlVGltaW5nIGlzIGEgcGxhY2UgaG9sZGVyIGZvciBzdG9yaW5nIHByb2ZpbGluZ1xuICAgICAqIGRhdGEgb2YgdGhlIGV4ZWN1dGlvbiAoZWFjaCBzdGFydC9lbmQgcGFpciByZWNvcmRzIHRoZSB0aW1lIHN0YW1wc1xuICAgICAqIGJlZm9yZS9hZnRlciByZXF1ZXN0IGV4ZWN1dGlvbilcbiAgICAgKlxuICAgICAqIEBwYXJhbSBtZXNzYWdlSWRcbiAgICAgKiBAcmV0dXJucyB7e21zZ0lkOiBzdHJpbmcsIGVycm9yOiB1bmRlZmluZWQsIHBheWxvYWQ6IHVuZGVmaW5lZCwgcGVyZm9ybWFuY2VUaW1pbmc6IHtyZXF1ZXN0U3RhcnQ6IHVuZGVmaW5lZCwgcmVxdWVzdEVuZDogdW5kZWZpbmVkfX19XG4gICAgICovXG4gICAgZnVuY3Rpb24gY3JlYXRlTmV3UmVzcG9uc2UobWVzc2FnZUlkOnN0cmluZyk6SUNvbnRleHR1YWxQZWVyUmVzcG9uc2Uge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbXNnSWQgICAgICA6IG1lc3NhZ2VJZCxcbiAgICAgICAgICAgIGVycm9yICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBwYXlsb2FkICAgIDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgcGVyZm9ybWFuY2VUaW1pbmc6IHtcbiAgICAgICAgICAgICAgICByZXF1ZXN0U3RhcnQ6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICByZXF1ZXN0RW5kICA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENhbGxlZCB3aGVuIHJlY2VpdmVkIGEgcnVudGltZSBtZXNzYWdlIGZyb20gdGhlIGV4dGVuc2lvbi5cbiAgICAgKiBGaXJzdCBjaGVjayBpZiB0aGUgbGlicmFyeSBjYW4gaGFuZGxlIHRoZSBtZXNzYWdlL3JlcXVlc3QgYW5kIG9ubHkgZm9yd2FyZFxuICAgICAqIGl0IHRvIHRoZSBsaWJyYXJ5IGlmIHllcy4gSXQgbG9ncyB0aGUgdGltZSB0b29rIGZvciB0aGUgbGlicmFyeSB0b1xuICAgICAqIGV4ZWN1dGUgdGhlIHJlcXVlc3QgYW5kIG9uY2UgaXQgaXMgZG9uZSwgc2VuZCB0aGUgcmVzdWx0IGJhY2tcbiAgICAgKiB0byB0aGUgZXh0ZW5zaW9uIGJ5IGV4ZWN1dGluZyB0aGUgY2FsbGJhY2sgcHJvdmlkZWQgYnkgcnVudGltZVxuICAgICAqXG4gICAgICogTm90ZTogXCJ0aGlzXCIgaXMgc3VwcG9zZSB0byBiaW5kIHRvIHRoZSBtb2R1bGUgbmFtZXNwYWNlXG4gICAgICpcbiAgICAgKiBAcGFyYW0gcmVxdWVzdFxuICAgICAqIEBwYXJhbSBzZW5kZXJcbiAgICAgKiBAcGFyYW0gc2VuZFJlc3BvbnNlXG4gICAgICovXG4gICAgZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZU1lc3NhZ2UocmVxdWVzdDpJQ29udGV4dHVhbFBlZXJSZXF1ZXN0LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRlcjpjaHJvbWUucnVudGltZS5NZXNzYWdlU2VuZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRSZXNwb25zZToocmVzcG9uc2U6SUNvbnRleHR1YWxQZWVyUmVzcG9uc2UpID0+IHZvaWQpOnZvaWQge1xuICAgICAgICBpZiAocmVxdWVzdCAmJiB0aGlzLmxpYnJhcnkuY2FuSGFuZGxlKHJlcXVlc3QudHlwZSkpIHtcblxuICAgICAgICAgICAgdmFyIHJlc3BvbnNlOklDb250ZXh0dWFsUGVlclJlc3BvbnNlID0gY3JlYXRlTmV3UmVzcG9uc2UocmVxdWVzdC5tc2dJZCk7XG5cbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmVzcG9uc2UucGVyZm9ybWFuY2VUaW1pbmcucmVxdWVzdFN0YXJ0ID0gdGhpcy5nZXRUaW1lKCk7XG5cbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBhbGxvdyB0byBhY2NlcHQgYW4gYXJyYXkgb2YgSUNvbnRleHR1YWxQZWVyUmVxdWVzdFxuICAgICAgICAgICAgICAgIC8vIGFuZCByZXR1cm4gYW4gYXJyYXkgb2YgcmVzcG9uc2VzIGZyb20gYWxsIHJlcXVlc3RcbiAgICAgICAgICAgICAgICByZXNwb25zZS5wYXlsb2FkID0gdGhpcy5saWJyYXJ5LmhhbmRsZShyZXF1ZXN0LnR5cGUsIHJlcXVlc3QucGF5bG9hZCk7XG5cbiAgICAgICAgICAgICAgICByZXNwb25zZS5wZXJmb3JtYW5jZVRpbWluZy5yZXF1ZXN0RW5kID0gdGhpcy5nZXRUaW1lKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaChlKSB7XG4gICAgICAgICAgICAgICAgLy8gUGFzc2luZyB3aG9sZSBlcnJvciBvYmplY3QgdG8gZXh0ZW5zaW9uIHJlc3VsdHMgaW4gZW1wdHkgb2JqZWN0IGluIHRoZSBleHRlbnNpb24uXG4gICAgICAgICAgICAgICAgLy8gU28gb25seSBwYXNzIHRoZSBlcnJvciBtZXNzYWdlLlxuICAgICAgICAgICAgICAgIHJlc3BvbnNlLmVycm9yID0gKGUgJiYgdHlwZW9mIGUudG9TdHJpbmcgPT09IFwiZnVuY3Rpb25cIik/IGUudG9TdHJpbmcoKSA6IFwiRXJyb3Igb2JqZWN0IGluIFNjcmFwZUNocm9tZURyaXZlciBpcyB1bmRlZmluZWQgb3IgaGFzIG5vIHRvU3RyaW5nIG1ldGhvZFwiO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmluYWxseSB7XG4gICAgICAgICAgICAgICAgc2VuZFJlc3BvbnNlKHJlc3BvbnNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEJvb3RzdHJhcHMgdGhlIGNvbnRleHR1YWwgcGVlciBsaWJyYXJ5IHRvIHRoZSBjb250ZXh0IHNjcmlwdCBydW50aW1lXG4gICAgICpcbiAgICAgKiBOb3RlOiBcInRoaXNcIiBpcyBzdXBwb3NlIHRvIGJpbmQgdG8gdGhlIG1vZHVsZSBuYW1lc3BhY2VcbiAgICAgKlxuICAgICAqL1xuICAgIGV4cG9ydCBmdW5jdGlvbiBib290c3RyYXAoKSB7XG4gICAgICAgIC8vIEFsbG93IGJvb3RzdHJhcCB0byBoYXBwZW4gb25seSBvbmNlIHBlciBKUkVcbiAgICAgICAgaWYgKCF0aGlzLmluaXRpYWxpemVkKSB7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemVkID0gdHJ1ZTtcblxuICAgICAgICAgICAgRXh0ZW5zaW9uTmFtZXNwYWNlLnJ1bnRpbWUub25NZXNzYWdlLmFkZExpc3RlbmVyKHRoaXMuaGFuZGxlTWVzc2FnZS5iaW5kKHRoaXMpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIGNhbGwgZXZlcnkgdGltZSB0aGUgZHJpdmVyIGlzIGluamVjdGVkIGJ1dCBvbmx5IHRoZSBmaXJzdCB3aWxsIHN1Y2NlZWRcbiAgICBTY3JhcGVDaHJvbWVEcml2ZXIuYm9vdHN0cmFwLmNhbGwoU2NyYXBlQ2hyb21lRHJpdmVyKTtcbn1cblxuIl19