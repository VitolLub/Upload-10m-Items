var IERuntimeMessageRouter=function(){"use strict";function e(){this._isStarted=!1,this._extensionPort=this._getExtensionPort(),this._panelPort=this._getPanelPort()}return e.prototype._getExtensionPort=function(){var t=document.getElementById(e._EXTENTION_IFRAME_ID);if(t)return t.contentWindow},e.prototype._getPanelPort=function(){var t=document.getElementById(e._PANEL_IFRAME_ID);if(t)return t.contentWindow},e.prototype.start=function(){this._isStarted&&console.log("IERuntimeMessageRouter has already been started and can only be started once."),this._isStarted=!0,this._setupRuntimeMessageListener()},e.prototype._setupRuntimeMessageListener=function(){window.addEventListener("message",this._runtimeMessageHandler.bind(this),!1)},e.prototype._runtimeMessageHandler=function(e){if(this._validOrigin(e)){var t=e.data;switch(this._determineMessageType(t)){case"Panel":this._forwardMessageToPanel(t);break;case"Extension":this._forwardMessageToExtension(t)}}},e.prototype._determineMessageType=function(t){return t.IEExtensionWrappedMessage?e._MESSAGE_FOR_PANEL:t.IEPanelWrappedMessage?e._MESSAGE_FOR_EXTENSION:void 0},e.prototype._forwardMessageToPanel=function(t){if(!this._panelPort)return void console.log("panelPort is not initialized");this._panelPort.postMessage(t,e._ORIGIN)},e.prototype._forwardMessageToExtension=function(t){if(!this._extensionPort)return void console.log("extensionPort is not initialized");this._extensionPort.postMessage(t,e._ORIGIN)},e.prototype._validOrigin=function(t){return t&&t.origin===e._ORIGIN},e._MESSAGE_FOR_PANEL="Panel",e._MESSAGE_FOR_EXTENSION="Extension",e._EXTENTION_IFRAME_ID="IEExtension",e._PANEL_IFRAME_ID="IEPanel",e._ORIGIN="res://aaresources.dll",e}();document.addEventListener("DOMContentLoaded",function(e){(new IERuntimeMessageRouter).start(),console.log("DOM completely loaded and IERuntimeMessageRouter is ready")});