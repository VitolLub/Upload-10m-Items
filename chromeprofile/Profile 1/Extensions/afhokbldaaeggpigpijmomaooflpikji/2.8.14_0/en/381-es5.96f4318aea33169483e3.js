!function(){var e,t,n,i,o,a,s,c,r,d,g,l,f,u,m,v,p,h,_,x,b,Z,A,k,y,q,T,C,M,w,P,O,S,J,Q,I,N,U,L,j,B;function z(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function D(e,t,n){return t&&$(e.prototype,t),n&&$(e,n),e}(self.webpackChunkangular_newtab=self.webpackChunkangular_newtab||[]).push([[381],{17381:function($,H,E){"use strict";E.r(H),E.d(H,{DialogsModule:function(){return St}});var F=E(55109),R=E(36278),K=E(67563),W=E(42304),V=E(33960),G=E(82932),X=E(28383),ee=E(35899);function te(e,t){1&e&&(W.TgZ(0,"div",7),W.TgZ(1,"div"),W._UZ(2,"img",8),W.TgZ(3,"span",9),W.SDv(4,10),W.qZA(),W.qZA(),W._UZ(5,"div"),W.qZA())}function ne(e,t){1&e&&(W.TgZ(0,"div",24),W.SDv(1,25),W.qZA())}var ie=function(e,t){return{"u-online":e,"u-offline":t}},oe=function(e){return["getWhenDate",e,!1]},ae=function(e){return{not_read:e}};function se(e,t){if(1&e&&(W.ynx(0),W.TgZ(1,"div",15),W._UZ(2,"img",16),W.qZA(),W.TgZ(3,"div",17),W.TgZ(4,"div",9),W.TgZ(5,"div",18),W._UZ(6,"i",19),W._uU(7),W.qZA(),W.TgZ(8,"div",20),W._uU(9),W.ALo(10,"callbackPipe"),W.qZA(),W.qZA(),W.TgZ(11,"div",21),W.YNc(12,ne,2,0,"div",22),W.TgZ(13,"div",23),W._uU(14),W.qZA(),W.qZA(),W.qZA(),W.BQk()),2&e){var n=W.oxw().$implicit,i=W.oxw(3);W.xp6(1),W.Q6J("matBadge",i.getCountNotRead(n)),W.xp6(1),W.Q6J("src",i.getUser(n,2).avatar[75],W.LSH)("srcset",i.getUser(n,2).avatar[150]+" 2x",W.LSH),W.xp6(4),W.Q6J("ngClass",W.WLB(12,ie,i.getUser(n,2).online,!i.getUser(n,2).online)),W.xp6(1),W.hij(" ",i.getUser(n,2).name+" "+i.getUser(n,2).surname," "),W.xp6(2),W.hij(" ",W.xi3(10,9,n.messages.length,W.VKq(15,oe,i.getLastMess(n).date))," "),W.xp6(3),W.Q6J("ngIf",i.getLastMess(n).user_id==i.commonService.user.id),W.xp6(1),W.Q6J("ngClass",W.VKq(17,ae,i.getLastMess(n).user_id==i.commonService.user.id&&i.getLastMess(n).not_read)),W.xp6(1),W.hij(" ",i.getLastMess(n).message," ")}}function ce(e,t){if(1&e&&(W.ynx(0),W.TgZ(1,"div",15),W._UZ(2,"img",26),W.qZA(),W.TgZ(3,"div",17),W.TgZ(4,"div",9),W.TgZ(5,"div"),W.ynx(6),W.SDv(7,27),W.BQk(),W._uU(8),W.qZA(),W.TgZ(9,"div",20),W._uU(10),W.ALo(11,"callbackPipe"),W.qZA(),W.qZA(),W.TgZ(12,"div",28),W.TgZ(13,"div"),W._uU(14),W.qZA(),W.qZA(),W.qZA(),W.BQk()),2&e){var n=W.oxw().$implicit,i=W.oxw(3);W.xp6(1),W.Q6J("matBadge",i.getCountNotRead(n)),W.xp6(7),W.hij(" ID ",n.data.contract.id,""),W.xp6(2),W.hij(" ",W.xi3(11,4,n.messages.length,W.VKq(7,oe,i.getLastMess(n).date))," "),W.xp6(4),W.Oqu(n.data.contract.title)}}function re(e,t){if(1&e&&(W.ynx(0),W.TgZ(1,"div",15),W._UZ(2,"img",29),W.qZA(),W.TgZ(3,"div",17),W.TgZ(4,"div",9),W.TgZ(5,"div"),W.SDv(6,30),W.qZA(),W.TgZ(7,"div",20),W._uU(8),W.ALo(9,"callbackPipe"),W.qZA(),W.qZA(),W.TgZ(10,"div",21),W.TgZ(11,"div",31),W._uU(12),W.qZA(),W.qZA(),W.qZA(),W.BQk()),2&e){var n=W.oxw().$implicit,i=W.oxw(3);W.xp6(1),W.Q6J("matBadge",i.getCountNotRead(n)),W.xp6(7),W.hij(" ",W.xi3(9,3,n.messages.length,W.VKq(6,oe,i.getLastMess(n).date))," "),W.xp6(4),W.Oqu(i.getLastMess(n).message)}}function de(e,t){if(1&e&&(W.ynx(0),W.TgZ(1,"div",15),W._UZ(2,"img",32),W.qZA(),W.TgZ(3,"div",17),W.TgZ(4,"div",9),W.TgZ(5,"div"),W.SDv(6,33),W.qZA(),W.TgZ(7,"div",20),W._uU(8),W.ALo(9,"callbackPipe"),W.qZA(),W.qZA(),W.TgZ(10,"div",21),W.TgZ(11,"div",31),W._uU(12),W.qZA(),W.qZA(),W.qZA(),W.BQk()),2&e){var n=W.oxw().$implicit,i=W.oxw(3);W.xp6(1),W.Q6J("matBadge",i.getCountNotRead(n)),W.xp6(7),W.hij(" ",W.xi3(9,3,n.messages.length,W.VKq(6,oe,i.getLastMess(n).date))," "),W.xp6(4),W.Oqu(i.clearMessageFromHTML(i.getLastMess(n).message))}}function ge(e,t){if(1&e&&(W.ynx(0),W._uU(1),W.BQk()),2&e){var n=W.oxw().$implicit,i=W.oxw(3);W.xp6(1),W.hij(" ",i.checkScrollOnAndLoad(n.id)," ")}}var le=function(e){return["/dialogs",e]};function fe(e,t){if(1&e&&(W.TgZ(0,"a",13),W.YNc(1,se,15,19,"ng-container",14),W.YNc(2,ce,15,9,"ng-container",14),W.YNc(3,re,13,8,"ng-container",14),W.YNc(4,de,13,8,"ng-container",14),W.YNc(5,ge,2,1,"ng-container",14),W.qZA()),2&e){var n=t.$implicit,i=t.index,o=W.oxw(3);W.Q6J("ngClass",W.VKq(8,ae,o.getLastMess(n).user_id!=o.commonService.user.id&&o.getLastMess(n).not_read))("routerLink",W.VKq(10,le,n.id))("id","dialog_"+n.id),W.xp6(1),W.Q6J("ngIf",0==n.type),W.xp6(1),W.Q6J("ngIf",1==n.type),W.xp6(1),W.Q6J("ngIf",2==n.type),W.xp6(1),W.Q6J("ngIf",3==n.type),W.xp6(1),W.Q6J("ngIf",i==o.commonService.dialogs.length-1)}}function ue(e,t){if(1&e&&(W.TgZ(0,"div",11),W.YNc(1,fe,6,12,"a",12),W.qZA()),2&e){var n=W.oxw(2);W.xp6(1),W.Q6J("ngForOf",n.commonService.dialogs)}}function me(e,t){if(1&e&&(W.TgZ(0,"div",4),W.YNc(1,te,6,0,"div",5),W.YNc(2,ue,2,1,"div",6),W.qZA()),2&e){var n=W.oxw();W.xp6(1),W.Q6J("ngIf",!n.commonService.dialogs.length),W.xp6(1),W.Q6J("ngIf",n.commonService.dialogs.length)}}function ve(e,t){1&e&&(W.TgZ(0,"div",34),W._UZ(1,"mat-progress-spinner",35),W.qZA())}var pe=function(){var s=function(){function e(t,n){Y(this,e),this.commonService=t,this.cdr=n}return D(e,[{key:"ngOnInit",value:function(){var e=this;this.getDialogs(),this.socket_reconnect_sub=this.commonService.socketService.socket_change_status.subscribe(function(t){"reconnect"==t&&e.getDialogs()})}},{key:"ngOnDestroy",value:function(){this.socket_reconnect_sub&&this.socket_reconnect_sub.unsubscribe()}},{key:"getDialogs",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.commonService.createRequest("get","dialogs",{offset:t}).toPromise().then(function(t){t.dialogs&&e.commonService.addToDialogs(t.dialogs),e.cdr.destroyed||e.cdr.detectChanges()})}},{key:"getUser",value:function(e,t){var n=this;return e.users.filter(function(e){return 1==t?e.id==n.commonService.user.id:e.id!=n.commonService.user.id}),e.users.filter(function(e){return 1==t?e.id==n.commonService.user.id:e.id!=n.commonService.user.id})[0]}},{key:"getLastMess",value:function(e){return e.messages[e.messages.length-1]}},{key:"checkScrollOnAndLoad",value:function(e){var t=this;setTimeout(function(){var n=document.getElementById("dialog_"+e);n&&(n.getAttribute("intersector")||(n.setAttribute("intersector","true"),t._setIntersectionObserver(n)))},50)}},{key:"_setIntersectionObserver",value:function(e){if(e){if(!this.intersection_observer){var t=this;this.intersection_observer=new IntersectionObserver(function(e){!0===e[0].isIntersecting&&(t.intersection_observer.unobserve(e[0].target),t.loadMoreDialogs())},{threshold:[0]})}this.intersection_observer.disconnect(),this.intersection_observer.observe(e)}}},{key:"loadMoreDialogs",value:function(){!this.commonService.dialogs||this.commonService.dialogs.length<20||this.getDialogs(this.commonService.dialogs.length)}},{key:"getCountNotRead",value:function(e){var t=this,n=0;return e.messages.forEach(function(e){e.not_read&&e.user_id!=t.commonService.user.id&&n++}),n||""}},{key:"clearMessageFromHTML",value:function(e){return e.replace(/<[^>]*>/g,"")}}]),e}();return s.\u0275fac=function(e){return new(e||s)(W.Y36(V.v),W.Y36(W.sBO))},s.\u0275cmp=W.Xpm({type:s,selectors:[["ng-component"]],decls:4,vars:2,consts:function(){return[[1,"h3"]," Conversations\n",["class","dialogs",4,"ngIf"],["class","page-loader",4,"ngIf"],[1,"dialogs"],["class","empty",4,"ngIf"],["style","width: 100%",4,"ngIf"],[1,"empty"],["src","https://maketime.online/img/undraw_chat.svg","alt",""],[1,"title"],"No messages",[2,"width","100%"],["class","dialog div",3,"ngClass","routerLink","id",4,"ngFor","ngForOf"],[1,"dialog","div",3,"ngClass","routerLink","id"],[4,"ngIf"],["matBadgeColor","accent","matBadgePosition","above after",1,"avatar",3,"matBadge"],["alt","",3,"src","srcset"],[1,"body"],[1,"username"],[1,"far","fa-circle",3,"ngClass"],[1,"date"],[1,"message"],["class","our-mess",4,"ngIf"],[1,"mess-text",3,"ngClass"],[1,"our-mess"],"You: ",["src","https://maketime.online/img/contract.svg","alt","",2,"padding","4px"],"Contract",[1,"info"],["src","https://maketime.online/img/active_support.svg","alt",""],"Contacting support",[1,"mess-text"],["src","https://maketime.online/img/info.svg","alt","",2,"width","60px"],"Notifications",[1,"page-loader"],["color","warn","mode","indeterminate"]]},template:function(e,t){1&e&&(W.TgZ(0,"div",0),W.SDv(1,1),W.qZA(),W.YNc(2,me,3,2,"div",2),W.YNc(3,ve,2,0,"div",3)),2&e&&(W.xp6(2),W.Q6J("ngIf",null!=t.commonService.dialogs),W.xp6(1),W.Q6J("ngIf",null==t.commonService.dialogs))},directives:[F.O5,F.sg,K.yS,F.mk,G.k,X.Ou],pipes:[ee.A],styles:[".h3[_ngcontent-%COMP%]{justify-content:space-between;margin:1rem;width:100%;text-align:left}.dialog[_ngcontent-%COMP%], .h3[_ngcontent-%COMP%]{display:flex}.dialog[_ngcontent-%COMP%]{justify-content:flex-start;border-top:1px solid var(--hr-color);padding:1rem;cursor:pointer}.dialog[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.dialog[_ngcontent-%COMP%]:last-child{border-bottom:1px solid var(--hr-color)}.avatar[_ngcontent-%COMP%]{margin-right:1rem;min-width:75px}.avatar[_ngcontent-%COMP%], .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:75px;height:75px;border-radius:15px}.body[_ngcontent-%COMP%]{width:100%;min-width:0}.title[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.title[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{font-size:1.1rem;display:flex;align-items:center}.title[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:rgba(0,0,0,.54);font-size:.8rem}.title[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{font-weight:500}.message[_ngcontent-%COMP%]{text-align:left;font-size:.9rem;margin-top:.5rem;display:flex;align-items:center}.message[_ngcontent-%COMP%]   .our-mess[_ngcontent-%COMP%]{font-weight:700;margin-right:5px}.message[_ngcontent-%COMP%]   .not_read[_ngcontent-%COMP%]{background-color:#74b9ff14;border-radius:5px;flex-grow:1;padding:1px 1px 1px 5px}.message[_ngcontent-%COMP%]   .mess-text[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.dialogs[_ngcontent-%COMP%]{display:flex;flex-grow:1}.dialogs[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]{display:flex;align-content:center;justify-content:center;flex-direction:column;width:100%;justify-content:space-around}.dialogs[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:250px}.dialogs[_ngcontent-%COMP%]   .empty[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.3rem;margin-top:1rem;color:#676767;display:inherit}.dialog.not_read[_ngcontent-%COMP%]{background-color:#74b9ff14}.body[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{text-align:left;font-size:.8rem;margin-top:.5rem}"]}),s}(),he=E(4391),_e=E(40485),xe=E(88269),be=E(94253),Ze=E(90095),Ae=E(82758),ke=E(19014),ye=E(34543),qe=["scrollMe"],Te=function(e,t){return{"u-online":e,"u-offline":t}};function Ce(e,t){if(1&e&&(W.TgZ(0,"div",13),W.TgZ(1,"span",14),W.SDv(2,15),W.qZA(),W.TgZ(3,"a",16),W._UZ(4,"i",17),W._uU(5),W.qZA(),W.qZA()),2&e){var n=W.oxw(3);W.xp6(3),W.Q6J("routerLink","/profile/"+n.getAnotherUser().id),W.xp6(1),W.Q6J("ngClass",W.WLB(3,Te,n.getAnotherUser().online,!n.getAnotherUser().online)),W.xp6(1),W.hij(" ",n.getAnotherUser().name+" "+n.getAnotherUser().surname,"")}}function Me(e,t){if(1&e&&(W.TgZ(0,"div",18),W.TgZ(1,"span",19),W.SDv(2,20),W.qZA(),W.TgZ(3,"a",16),W._uU(4),W.qZA(),W.qZA()),2&e){var n=W.oxw(3);W.xp6(3),W.Q6J("routerLink","/space/contract/"+n.dialog.data.contract.id),W.xp6(1),W.hij(" ",n.dialog.data.contract.title," ")}}function we(e,t){1&e&&(W.TgZ(0,"div",18),W.SDv(1,21),W.qZA())}function Pe(e,t){1&e&&(W.TgZ(0,"div",18),W.SDv(1,22),W.qZA())}function Oe(e,t){if(1&e&&(W.ynx(0),W.YNc(1,Ce,6,6,"div",5),W.YNc(2,Me,5,2,"div",12),W.YNc(3,we,2,0,"div",12),W.YNc(4,Pe,2,0,"div",12),W.BQk()),2&e){var n=W.oxw(2);W.xp6(1),W.Q6J("ngIf",0==n.dialog.type),W.xp6(1),W.Q6J("ngIf",1==n.dialog.type),W.xp6(1),W.Q6J("ngIf",2==n.dialog.type),W.xp6(1),W.Q6J("ngIf",3==n.dialog.type)}}function Se(e,t){if(1&e&&(W.TgZ(0,"div",13),W.TgZ(1,"span",14),W.SDv(2,23),W.qZA(),W.TgZ(3,"a",16),W._UZ(4,"i",17),W._uU(5),W.qZA(),W.qZA()),2&e){var n=W.oxw(2);W.xp6(3),W.Q6J("routerLink","/profile/"+n.user.id),W.xp6(1),W.Q6J("ngClass",W.WLB(3,Te,n.user.online,!n.user.online)),W.xp6(1),W.hij(" ",n.user.name+" "+n.user.surname,"")}}var Je=function(e,t){return["getAttach",e,"url",t]},Qe=function(e,t){return["getAttach",e,"name",t]};function Ie(e,t){if(1&e&&(W.TgZ(0,"div",34),W.TgZ(1,"a",35),W.ALo(2,"callbackPipe"),W._UZ(3,"i",36),W._uU(4),W.ALo(5,"callbackPipe"),W.qZA(),W.qZA()),2&e){var n=W.oxw(2).$implicit;W.xp6(1),W.Q6J("href",W.xi3(2,2,n,W.WLB(8,Je,n.attach,n.user_id)),W.LSH),W.xp6(3),W.hij(" ",W.xi3(5,5,n,W.WLB(11,Qe,n.attach,n.user_id)),"")}}var Ne=function(e){return["getWhenDate",e,!1]},Ue=function(e){return["getHTMLText",e]};function Le(e,t){if(1&e&&(W.ynx(0),W.TgZ(1,"div",26),W._UZ(2,"img",27),W.qZA(),W.TgZ(3,"div",28),W.TgZ(4,"div",29),W.TgZ(5,"div",30),W.TgZ(6,"a",16),W._uU(7),W.qZA(),W.qZA(),W.TgZ(8,"div",31),W._uU(9),W.ALo(10,"callbackPipe"),W.qZA(),W.qZA(),W._UZ(11,"div",32),W.ALo(12,"callbackPipe"),W.YNc(13,Ie,6,14,"div",33),W.qZA(),W.BQk()),2&e){var n=W.oxw().$implicit,i=W.oxw(3);W.xp6(2),W.Q6J("src",i.getUserById(n.user_id).avatar[50],W.LSH)("srcset",i.getUserById(n.user_id).avatar[100]+" 2x",W.LSH),W.xp6(4),W.Q6J("routerLink","/profile/"+n.user_id),W.xp6(1),W.Oqu(i.getUserById(n.user_id).name+" "+i.getUserById(n.user_id).surname),W.xp6(2),W.hij(" ",W.xi3(10,7,n.date,W.VKq(13,Ne,n.date))," "),W.xp6(2),W.Q6J("innerHTML",W.xi3(12,10,n.message,W.VKq(15,Ue,n.message)),W.oJD),W.xp6(2),W.Q6J("ngIf",n.attach)}}function je(e,t){if(1&e&&(W.TgZ(0,"div",42),W.ynx(1),W.SDv(2,43),W.BQk(),W.TgZ(3,"a",16),W._uU(4),W.qZA(),W.ynx(5),W.SDv(6,44),W.BQk(),W.TgZ(7,"a",16),W._uU(8),W.qZA(),W.ynx(9),W.SDv(10,45),W.BQk(),W.TgZ(11,"a",16),W._uU(12),W.qZA(),W._uU(13,". "),W._UZ(14,"br"),W.ynx(15),W.tHW(16,46),W._UZ(17,"br"),W._UZ(18,"br"),W.N_p(),W.BQk(),W.qZA()),2&e){var n=W.oxw(2).$implicit,i=W.oxw(3);W.xp6(3),W.Q6J("routerLink","/space/contract/"+i.dialog.data.contract.id),W.xp6(1),W.hij(" ID ",i.dialog.data.contract.id," "),W.xp6(3),W.Q6J("routerLink","/profile/"+n.data.user_customer.id),W.xp6(1),W.hij(" ",n.data.user_customer.name," "),W.xp6(3),W.Q6J("routerLink","/profile/"+n.data.user_employee.id),W.xp6(1),W.hij(" ",n.data.user_employee.name,"")}}function Be(e,t){1&e&&(W.TgZ(0,"div",42),W.SDv(1,47),W.qZA())}function ze(e,t){1&e&&(W.TgZ(0,"div",42),W.SDv(1,48),W.qZA())}function Ye(e,t){1&e&&(W.TgZ(0,"div",42),W.SDv(1,49),W.qZA())}function $e(e,t){1&e&&(W.TgZ(0,"div",42),W.SDv(1,50),W.qZA())}function De(e,t){1&e&&(W.TgZ(0,"div"),W.tHW(1,53),W._UZ(2,"span",54),W.N_p(),W.qZA())}function He(e,t){1&e&&(W.TgZ(0,"div"),W.tHW(1,55),W._UZ(2,"span",54),W.N_p(),W.qZA())}var Ee=function(e){return["getWhenDate",e,!0]};function Fe(e,t){if(1&e&&(W.TgZ(0,"div"),W.ynx(1),W.SDv(2,56),W.BQk(),W._uU(3),W.ALo(4,"callbackPipe"),W.ynx(5),W.SDv(6,57),W.BQk(),W.qZA()),2&e){var n=W.oxw(3).$implicit;W.xp6(3),W.Oqu(W.xi3(4,1,n.data.unixtime_end,W.VKq(4,Ee,n.data.unixtime_end)))}}function Re(e,t){if(1&e){var n=W.EpF();W.TgZ(0,"div",58),W.TgZ(1,"button",59),W.NdJ("click",function(){W.CHM(n);var e=W.oxw(3).$implicit;return W.oxw(3).messageAction("contract-request",e,!0)}),W.SDv(2,60),W.qZA(),W.TgZ(3,"button",6),W.NdJ("click",function(){W.CHM(n);var e=W.oxw(3).$implicit;return W.oxw(3).messageAction("contract-request",e,!1)}),W.SDv(4,61),W.qZA(),W.qZA()}}function Ke(e,t){if(1&e&&(W.TgZ(0,"div",42),W.ynx(1),W.SDv(2,51),W.BQk(),W.YNc(3,De,3,0,"div",4),W.YNc(4,He,3,0,"div",4),W.YNc(5,Fe,7,6,"div",4),W.YNc(6,Re,5,0,"div",52),W.qZA()),2&e){var n=W.oxw(2).$implicit;W.xp6(3),W.Q6J("ngIf",2==n.data.status),W.xp6(1),W.Q6J("ngIf",1==n.data.status),W.xp6(1),W.Q6J("ngIf",0==n.data.status),W.xp6(1),W.Q6J("ngIf",0==n.data.status&&"employee"==n.data.my_role)}}function We(e,t){1&e&&(W.TgZ(0,"div"),W.tHW(1,63),W._UZ(2,"span",54),W.N_p(),W.qZA())}function Ve(e,t){1&e&&(W.TgZ(0,"div"),W.tHW(1,64),W._UZ(2,"span",54),W.N_p(),W.qZA())}function Ge(e,t){if(1&e&&(W.TgZ(0,"div"),W.ynx(1),W.SDv(2,65),W.BQk(),W._uU(3),W.ALo(4,"callbackPipe"),W.ynx(5),W.SDv(6,66),W.BQk(),W.qZA()),2&e){var n=W.oxw(3).$implicit;W.xp6(3),W.hij(" ",W.xi3(4,1,n.data.unixtime_end,W.VKq(4,Ee,n.data.unixtime_end)),"")}}function Xe(e,t){if(1&e){var n=W.EpF();W.TgZ(0,"div",58),W.TgZ(1,"button",59),W.NdJ("click",function(){W.CHM(n);var e=W.oxw(3).$implicit;return W.oxw(3).messageAction("contract-request",e,!0)}),W.SDv(2,67),W.qZA(),W.TgZ(3,"button",6),W.NdJ("click",function(){W.CHM(n);var e=W.oxw(3).$implicit;return W.oxw(3).messageAction("contract-request",e,!1)}),W.SDv(4,68),W.qZA(),W.qZA()}}function et(e,t){if(1&e&&(W.TgZ(0,"div",42),W.ynx(1),W.SDv(2,62),W.BQk(),W.YNc(3,We,3,0,"div",4),W.YNc(4,Ve,3,0,"div",4),W.YNc(5,Ge,7,6,"div",4),W.YNc(6,Xe,5,0,"div",52),W.qZA()),2&e){var n=W.oxw(2).$implicit;W.xp6(3),W.Q6J("ngIf",2==n.data.status),W.xp6(1),W.Q6J("ngIf",1==n.data.status),W.xp6(1),W.Q6J("ngIf",0==n.data.status),W.xp6(1),W.Q6J("ngIf",0==n.data.status&&"customer"==n.data.my_role)}}function tt(e,t){1&e&&(W.TgZ(0,"div",42),W.SDv(1,69),W.qZA())}function nt(e,t){1&e&&(W.TgZ(0,"div",42),W.tHW(1,70),W._UZ(2,"br"),W._UZ(3,"br"),W._UZ(4,"br"),W._UZ(5,"br"),W._UZ(6,"br"),W.N_p(),W.qZA())}function it(e,t){if(1&e&&W._UZ(0,"div",71),2&e){var n=W.oxw(2).$implicit;W.Q6J("innerHTML",n.message,W.oJD)}}function ot(e,t){if(1&e&&(W.TgZ(0,"div",34),W.TgZ(1,"a",35),W.ALo(2,"callbackPipe"),W._UZ(3,"i",36),W._uU(4),W.ALo(5,"callbackPipe"),W.qZA(),W.qZA()),2&e){var n=W.oxw(2).$implicit;W.xp6(1),W.Q6J("href",W.xi3(2,2,n,W.WLB(8,Je,n.attach,n.user_id)),W.LSH),W.xp6(3),W.hij(" ",W.xi3(5,5,n,W.WLB(11,Qe,n.attach,n.user_id)),"")}}function at(e,t){if(1&e&&(W.ynx(0),W.TgZ(1,"div",26),W._UZ(2,"img",37),W.qZA(),W.TgZ(3,"div",38),W.TgZ(4,"div",29),W.TgZ(5,"div",30),W.SDv(6,39),W.qZA(),W.TgZ(7,"div",31),W._uU(8),W.ALo(9,"callbackPipe"),W.qZA(),W.qZA(),W.YNc(10,je,19,6,"div",40),W.YNc(11,Be,2,0,"div",40),W.YNc(12,ze,2,0,"div",40),W.YNc(13,Ye,2,0,"div",40),W.YNc(14,$e,2,0,"div",40),W.YNc(15,Ke,7,4,"div",40),W.YNc(16,et,7,4,"div",40),W.YNc(17,tt,2,0,"div",40),W.YNc(18,nt,7,0,"div",40),W.YNc(19,it,1,1,"div",41),W.YNc(20,ot,6,14,"div",33),W.qZA(),W.BQk()),2&e){var n=W.oxw().$implicit;W.xp6(8),W.hij(" ",W.xi3(9,12,n.date,W.VKq(15,Ne,n.date))," "),W.xp6(2),W.Q6J("ngIf",1==n.sub_type),W.xp6(1),W.Q6J("ngIf",2==n.sub_type),W.xp6(1),W.Q6J("ngIf",3==n.sub_type),W.xp6(1),W.Q6J("ngIf",4==n.sub_type),W.xp6(1),W.Q6J("ngIf",5==n.sub_type),W.xp6(1),W.Q6J("ngIf",6==n.sub_type),W.xp6(1),W.Q6J("ngIf",7==n.sub_type),W.xp6(1),W.Q6J("ngIf",8==n.sub_type),W.xp6(1),W.Q6J("ngIf",9==n.sub_type),W.xp6(1),W.Q6J("ngIf",10==n.sub_type),W.xp6(1),W.Q6J("ngIf",n.attach)}}function st(e,t){if(1&e&&(W.TgZ(0,"div",34),W.TgZ(1,"a",35),W.ALo(2,"callbackPipe"),W._UZ(3,"i",36),W._uU(4),W.ALo(5,"callbackPipe"),W.qZA(),W.qZA()),2&e){var n=W.oxw(2).$implicit;W.xp6(1),W.Q6J("href",W.xi3(2,2,n,W.WLB(8,Je,n.attach,n.user_id)),W.LSH),W.xp6(3),W.hij(" ",W.xi3(5,5,n,W.WLB(11,Qe,n.attach,n.user_id)),"")}}function ct(e,t){if(1&e&&(W.ynx(0),W.TgZ(1,"div",26),W._UZ(2,"img",37),W.qZA(),W.TgZ(3,"div",38),W.TgZ(4,"div",29),W.TgZ(5,"div",30),W.SDv(6,72),W.qZA(),W.TgZ(7,"div",31),W._uU(8),W.ALo(9,"callbackPipe"),W.qZA(),W.qZA(),W._UZ(10,"div",32),W.ALo(11,"callbackPipe"),W.YNc(12,st,6,14,"div",33),W.qZA(),W.BQk()),2&e){var n=W.oxw().$implicit;W.xp6(8),W.hij(" ",W.xi3(9,3,n.date,W.VKq(9,Ne,n.date))," "),W.xp6(2),W.Q6J("innerHTML",W.xi3(11,6,n.message,W.VKq(11,Ue,n.message)),W.oJD),W.xp6(2),W.Q6J("ngIf",n.attach)}}function rt(e,t){if(1&e&&(W.TgZ(0,"div",34),W.TgZ(1,"a",35),W.ALo(2,"callbackPipe"),W._UZ(3,"i",36),W._uU(4),W.ALo(5,"callbackPipe"),W.qZA(),W.qZA()),2&e){var n=W.oxw(2).$implicit;W.xp6(1),W.Q6J("href",W.xi3(2,2,n,W.WLB(8,Je,n.attach,n.user_id)),W.LSH),W.xp6(3),W.hij(" ",W.xi3(5,5,n,W.WLB(11,Qe,n.attach,n.user_id)),"")}}function dt(e,t){if(1&e&&(W.ynx(0),W.TgZ(1,"div",26),W._UZ(2,"img",73),W.qZA(),W.TgZ(3,"div",38),W.TgZ(4,"div",29),W.TgZ(5,"div",30),W.SDv(6,74),W.qZA(),W.TgZ(7,"div",31),W._uU(8),W.ALo(9,"callbackPipe"),W.qZA(),W.qZA(),W._UZ(10,"div",32),W.ALo(11,"callbackPipe"),W.YNc(12,rt,6,14,"div",33),W.qZA(),W.BQk()),2&e){var n=W.oxw().$implicit;W.xp6(8),W.hij(" ",W.xi3(9,3,n.date,W.VKq(9,Ne,n.date))," "),W.xp6(2),W.Q6J("innerHTML",W.xi3(11,6,n.message,W.VKq(11,Ue,n.message)),W.oJD),W.xp6(2),W.Q6J("ngIf",n.attach)}}function gt(e,t){if(1&e&&(W.ynx(0),W._uU(1),W.BQk()),2&e){var n=W.oxw().$implicit,i=W.oxw(3);W.xp6(1),W.hij(" ",i.checkScrollOnAndLoad(n.id)," ")}}var lt=function(e){return{not_read:e}};function ft(e,t){if(1&e&&(W.TgZ(0,"div",25),W.YNc(1,Le,14,17,"ng-container",4),W.YNc(2,at,21,17,"ng-container",4),W.YNc(3,ct,13,13,"ng-container",4),W.YNc(4,dt,13,13,"ng-container",4),W.YNc(5,gt,2,1,"ng-container",4),W.qZA()),2&e){var n=t.$implicit,i=t.index;W.Q6J("id","message_"+n.id)("ngClass",W.VKq(7,lt,n.not_read)),W.xp6(1),W.Q6J("ngIf",0==n.type),W.xp6(1),W.Q6J("ngIf",1==n.type),W.xp6(1),W.Q6J("ngIf",2==n.type),W.xp6(1),W.Q6J("ngIf",3==n.type),W.xp6(1),W.Q6J("ngIf",1==i)}}function ut(e,t){if(1&e&&(W.ynx(0),W.YNc(1,ft,6,9,"div",24),W.BQk()),2&e){var n=W.oxw(2);W.xp6(1),W.Q6J("ngForOf",n.dialog.messages)}}var mt=function(){return{position:"absolute",bottom:"90px",right:"20%",width:"338px","z-index":"1"}};function vt(e,t){if(1&e){var n=W.EpF();W.TgZ(0,"emoji-mart",91),W.NdJ("emojiClick",function(e){return W.CHM(n),W.oxw(3).addEmoji(e)}),W.qZA()}if(2&e){var i=W.oxw(3);W.Akn(W.DdM(6,mt)),W.Q6J("darkMode",!1)("i18n",i.emoji_l18n)("showPreview",!1)("isNative",!0)}}function pt(e,t){if(1&e){var n=W.EpF();W.TgZ(0,"i",92),W.NdJ("click",function(){return W.CHM(n),W.oxw(3).createNewContract()}),W.qZA()}}function ht(e,t){if(1&e){var n=W.EpF();W.TgZ(0,"div",93),W._uU(1),W.TgZ(2,"i",94),W.NdJ("click",function(){return W.CHM(n),W.oxw(3).file=null}),W.qZA(),W.qZA()}if(2&e){var i=W.oxw(3);W.xp6(1),W.hij(" ",i.file.name," ")}}function _t(e,t){1&e&&(W.TgZ(0,"span"),W.SDv(1,95),W.qZA())}function xt(e,t){1&e&&(W.TgZ(0,"div",96),W.TgZ(1,"div",97),W._UZ(2,"div"),W.qZA(),W.qZA())}function bt(e,t){1&e&&(W.TgZ(0,"span"),W._UZ(1,"i",98),W.qZA())}function Zt(e,t){1&e&&(W.TgZ(0,"div",96),W.TgZ(1,"div",97),W._UZ(2,"div"),W.qZA(),W.qZA())}var At=function(){return{standalone:!0}};function kt(e,t){if(1&e){var n=W.EpF();W.TgZ(0,"div",75),W.TgZ(1,"div",76),W.YNc(2,vt,1,7,"emoji-mart",77),W.TgZ(3,"form",78),W.NdJ("submit",function(){return W.CHM(n),W.oxw(2).sendMessage()}),W.TgZ(4,"mat-form-field"),W.TgZ(5,"textarea",79),W.NdJ("ngModelChange",function(e){return W.CHM(n),W.oxw(2).send_message=e}),W.qZA(),W.TgZ(6,"div",80),W.TgZ(7,"i",81),W.NdJ("click",function(){W.CHM(n);var e=W.oxw(2);return e.show_emoji=!e.show_emoji}),W.qZA(),W.TgZ(8,"i",82),W.NdJ("click",function(){W.CHM(n);var e=W.MAs(11),t=W.oxw(2);return e.click(),t.show_emoji=!1}),W.qZA(),W.YNc(9,pt,1,0,"i",83),W.qZA(),W.qZA(),W.TgZ(10,"input",84,85),W.NdJ("change",function(){return W.CHM(n),W.oxw(2).onFileSelected()}),W.qZA(),W.qZA(),W.YNc(12,ht,3,1,"div",86),W.qZA(),W.TgZ(13,"div",87),W.TgZ(14,"button",88),W.NdJ("click",function(){return W.CHM(n),W.oxw(2).sendMessage()}),W.YNc(15,_t,2,0,"span",4),W.YNc(16,xt,3,0,"div",89),W.qZA(),W.TgZ(17,"button",90),W.NdJ("click",function(){return W.CHM(n),W.oxw(2).sendMessage()}),W.YNc(18,bt,2,0,"span",4),W.YNc(19,Zt,3,0,"div",89),W.qZA(),W.qZA(),W.qZA()}if(2&e){var i=W.oxw(2);W.xp6(2),W.Q6J("ngIf",i.show_emoji),W.xp6(3),W.Q6J("ngModelOptions",W.DdM(11,At))("ngModel",i.send_message),W.xp6(4),W.Q6J("ngIf",i.dialog&&2!=i.dialog.type||i.user),W.xp6(3),W.Q6J("ngIf",i.file),W.xp6(2),W.Q6J("disabled",i.is_send_message),W.xp6(1),W.Q6J("ngIf",!i.is_send_message),W.xp6(1),W.Q6J("ngIf",i.is_send_message),W.xp6(1),W.Q6J("disabled",i.is_send_message),W.xp6(1),W.Q6J("ngIf",!i.is_send_message),W.xp6(1),W.Q6J("ngIf",i.is_send_message)}}var yt=function(e){return{full:e}};function qt(e,t){if(1&e){var n=W.EpF();W.TgZ(0,"div",2),W.TgZ(1,"div",3),W.YNc(2,Oe,5,4,"ng-container",4),W.YNc(3,Se,6,6,"div",5),W.TgZ(4,"div"),W.TgZ(5,"button",6),W.NdJ("click",function(){return W.CHM(n),W.oxw().goBack()}),W.SDv(6,7),W.qZA(),W.qZA(),W.qZA(),W.TgZ(7,"div",8),W.TgZ(8,"div",9,10),W.YNc(10,ut,2,1,"ng-container",4),W.qZA(),W.YNc(11,kt,20,12,"div",11),W.qZA(),W.qZA()}if(2&e){var i=W.oxw();W.xp6(2),W.Q6J("ngIf",i.dialog),W.xp6(1),W.Q6J("ngIf",i.user&&!i.dialog),W.xp6(5),W.Q6J("ngClass",W.VKq(5,yt,i.dialog&&3==i.dialog.type)),W.xp6(2),W.Q6J("ngIf",i.dialog),W.xp6(1),W.Q6J("ngIf",!i.dialog||i.dialog&&3!=i.dialog.type)}}function Tt(e,t){1&e&&(W.TgZ(0,"div",99),W._UZ(1,"mat-progress-spinner",100),W.qZA())}var Ct,Mt=function(){var e=function(){function e(t,n,i,o,a,s,c){var r=this;Y(this,e),this.commonService=t,this._snackBar=n,this._location=i,this.router=o,this.route=a,this.cdr=s,this.dialogModal=c,this.send_message="",this.is_send_message=!1,this.markForCheck_sub=null,this.show_emoji=!1,this.emoji_l18n={search:_e["\u041f\u043e\u0438\u0441\u043a"],notfound:_e["\u041d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"],categories:{search:_e["\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u043f\u043e\u0438\u0441\u043a\u0430"],recent:_e["\u041d\u0435\u0434\u0430\u0432\u043d\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0435"],people:_e["\u042d\u043c\u043e\u0434\u0437\u0438"],nature:_e["\u0416\u0438\u0432\u043e\u0442\u043d\u044b\u0435 \u0438 \u043f\u0440\u0438\u0440\u043e\u0434\u0430"],foods:_e["\u0415\u0434\u0430 \u0438 \u043d\u0430\u043f\u0438\u0442\u043a\u0438"],activity:_e["\u041c\u0435\u0440\u043e\u043f\u0440\u0438\u044f\u0442\u0438\u044f"],places:_e["\u041c\u0435\u0441\u0442\u0430"],objects:_e["\u041f\u0440\u0435\u0434\u043c\u0435\u0442\u044b"],symbols:_e["\u0421\u0438\u043c\u0432\u043e\u043b\u044b"],flags:_e["\u0424\u043b\u0430\u0433\u0438"],custom:_e["\u0414\u0440\u0443\u0433\u043e\u0435"]}},this.not_read_checked_mess_count=0,this.route.params.subscribe(function(e){if(e.dialog_id){var t,n=e.dialog_id;r.dialog&&r.dialog.id!=n&&(r.dialog=null),r.commonService.dialogs&&((t=r.commonService.dialogs.filter(function(e){return e.id==n})).length&&(r.dialog=t[0],r.scrollToBottom())),r.dialog||r.commonService.createRequest("get","dialogs",{dialog_id:n,offset:Array.isArray(r.commonService.dialogs)?r.commonService.dialogs.length:0}).toPromise().then(function(e){if(e.dialogs){if(r.commonService.addToDialogs(e.dialogs),!(t=r.commonService.dialogs.filter(function(e){return e.id==n})).length)return r.router.navigate(["/dialogs"]);r.dialog=t[0],r.scrollToBottom()}r.cdr.detectChanges()})}else if(e.user_id){if(e.user_id==r.commonService.user.id)return r.router.navigate(["/dialogs"]);if(r.commonService.dialogs){var i=r.commonService.dialogs.filter(function(t){var n;if(0==t.type)return t.users.forEach(function(t){t.id==e.user_id&&(n=!0)}),n});if(i[0])return r.router.navigate(["/dialogs",i[0].id])}r.commonService.createRequest("get","dialogs",{offset:Array.isArray(r.commonService.dialogs)?r.commonService.dialogs.length:0,user_id:e.user_id}).toPromise().then(function(t){if(t.dialogs.length){r.commonService.addToDialogs(t.dialogs);var n=r.commonService.dialogs.filter(function(t){var n;return t.users.forEach(function(t){t.id==e.user_id&&(n=!0)}),n});n.length&&(r.dialog=n[0])}else t.user&&(r.user=t.user,r.markForCheck_sub=r.commonService.markForCheck_sub.subscribe(function(){if(r.commonService.dialogs){var e=r.commonService.dialogs.filter(function(e){var t;return e.users.forEach(function(e){e.id==r.user.id&&(t=!0)}),t});e.length&&(r.dialog=e[0],r.markForCheck_sub.unsubscribe(),r.cdr.detectChanges())}}));r.cdr.detectChanges()})}})}return D(e,[{key:"ngOnInit",value:function(){var e=this;this.socket_reconnect_sub=this.commonService.socketService.socket_change_status.subscribe(function(t){"reconnect"==t&&e.updateMessages()})}},{key:"ngOnDestroy",value:function(){this.markForCheck_sub&&this.markForCheck_sub.unsubscribe(),this.socket_reconnect_sub&&this.socket_reconnect_sub.unsubscribe()}},{key:"onWindowFocus",value:function(e){this.setMessagesAsRead()}},{key:"getUserById",value:function(e){if(this.dialog)return this.dialog.users.filter(function(t){return t.id==e})[0]}},{key:"getAnotherUser",value:function(){var e=this;return this.dialog?this.dialog.users.filter(function(t){return t.id!=e.commonService.user.id})[0]:this.user?this.user:void 0}},{key:"goBack",value:function(){"/support"==this.commonService.previousUrl&&this.router.navigate(["/dialogs"]),this.commonService.previousUrl&&!this.commonService.previousUrl.match(/\/dialogs\/user\//)?this._location.back():this.commonService.previousUrl_2&&!this.commonService.previousUrl_2.match(/\/dialogs\/user\//)?this.router.navigate([this.commonService.previousUrl_2]):this.router.navigate(["/dialogs"])}},{key:"scrollToBottom",value:function(){try{this.myScrollContainer.nativeElement.scrollTop=this.myScrollContainer.nativeElement.scrollHeight}catch(e){}}},{key:"sendMessage",value:function(){var e=this;if(this.send_message||this.file){this.show_emoji=!1,this.is_send_message=!0;var t=new FormData;t.append("file",this.file),t.append("message",this.send_message),this.dialog?t.append("dialog_id",this.dialog.id.toString()):this.user&&t.append("user_id",this.user.id.toString()),this.commonService.createRequest("post","dialogs/message",t).toPromise().then(function(t){if(e.dialog&&t.message)e.commonService.addToDialogs(null,[t.message]);else if(e.user&&t.dialog){e.commonService.addToDialogs([t.dialog]);var n=t.dialog.id,i=e.commonService.dialogs.filter(function(e){return e.id==n});i.length&&(e.dialog=i[0]),e.markForCheck_sub&&e.markForCheck_sub.unsubscribe()}e.send_message="",e.is_send_message=!1,e.file=null,e.cdr.detectChanges()}).catch(function(){e.is_send_message=!1,e.cdr.detectChanges()})}}},{key:"onFileSelected",value:function(){var e=document.querySelector("#file");e.files[0]&&(e.files[0].size>5e6?(this.file=null,this._snackBar.open(_e.max_file_size_error,null,{verticalPosition:"top",duration:3e3})):this.file=e.files[0]),this.cdr.detectChanges()}},{key:"addEmoji",value:function(e){var t=document.getElementById("messageText");if(document.selection)t.focus(),document.selection.createRange().text=e.emoji.native;else if(window.navigator.userAgent.indexOf("Edge")>-1){var n=t.selectionEnd;t.value=t.value.substring(0,o=t.selectionStart)+e.emoji.native+t.value.substring(n,t.value.length);var i=o+e.emoji.native.length;t.focus(),t.setSelectionRange(i,i)}else if(t.selectionStart||"0"==t.selectionStart){var o;n=t.selectionEnd,t.value=t.value.substring(0,o=t.selectionStart)+e.emoji.native+t.value.substring(n,t.value.length)}else t.value+=e.emoji.native;var a=document.createEvent("HTMLEvents");a.initEvent("input",!1,!0),t.dispatchEvent(a)}},{key:"ngAfterViewChecked",value:function(){this.dialog&&this.dialog.messages.length!=this.prev_count_messages&&(this.prev_count_messages=this.dialog.messages.length,this.scrollToBottom()),this.setMessagesAsRead()}},{key:"setMessagesAsRead",value:function(){var e=this;if(document.hasFocus()&&this.dialog&&this.not_read_checked_mess_count!=this.dialog.messages.length){this.not_read_checked_mess_count=this.dialog.messages.length;var t=this;setTimeout(function(){var n=!1;if(t.dialog.messages.forEach(function(e,i){e.not_read&&e.user_id!=t.commonService.user.id&&(t.dialog.messages[i].not_read=!1,n=!0)}),n){if(e.commonService.notifications){var i=e.commonService.notifications.dialogs.indexOf(e.dialog.id);-1!==i&&e.commonService.notifications.dialogs.splice(i,1)}t.commonService.createRequest("post","dialogs/set-read",{dialog_id:t.dialog.id}).toPromise(),t.cdr.destroyed||t.cdr.detectChanges()}},1e3)}}},{key:"checkScrollOnAndLoad",value:function(e){if(this.dialog){var t=this;setTimeout(function(){var n=document.getElementById("message_"+e);n&&(n.getAttribute("intersector")||(n.setAttribute("intersector","true"),t._setIntersectionObserver(n)))},50)}}},{key:"_setIntersectionObserver",value:function(e){if(e){if(!this.intersection_observer){var t=this;this.intersection_observer=new IntersectionObserver(function(e){!0===e[0].isIntersecting&&(t.intersection_observer.unobserve(e[0].target),t.loadMoreMessages())},{threshold:[0]})}this.intersection_observer.disconnect(),this.intersection_observer.observe(e)}}},{key:"loadMoreMessages",value:function(){var e=this;this.commonService.createRequest("get","messages",{offset:this.dialog.messages.length,dialog_id:this.dialog.id}).toPromise().then(function(t){if(t&&t.length){var n=document.getElementById("messages_content"),i=n.scrollTop,o=n.scrollHeight-n.clientHeight;e.commonService.addToDialogs(null,t),e.prev_count_messages=e.dialog.messages.length,n.scrollTop=i+(n.scrollHeight-n.clientHeight-o)}e.cdr.destroyed||e.cdr.detectChanges()})}},{key:"updateMessages",value:function(){var e=this;this.dialog&&this.commonService.createRequest("get","messages",{offset:0,dialog_id:this.dialog.id}).toPromise().then(function(t){if(t&&t.length){var n=document.getElementById("messages_content"),i=n.scrollTop,o=n.scrollHeight-n.clientHeight;e.commonService.addToDialogs(null,t),e.prev_count_messages=e.dialog.messages.length,n.scrollTop=i+(n.scrollHeight-n.clientHeight-o)}e.cdr.destroyed||e.cdr.detectChanges()})}},{key:"createNewContract",value:function(){this.dialogModal.open(he.a,{data:{type:"new_contract",my_role:0,to_user:this.getAnotherUser(),title:"",desc:"",h:0,m:0,rate:"",rate_cur:""}}).afterClosed().subscribe(function(e){})}},{key:"messageAction",value:function(e,t,n){var i=this;switch(e){case"contract-request":this.commonService.createRequest("post","delegate/contract-request/answer",{id:t.data.contract_request_id,type:n}).toPromise().then(function(e){e.status&&(t.data.status=e.status,i.cdr.detectChanges())})}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(W.Y36(V.v),W.Y36(xe.ux),W.Y36(F.Ye),W.Y36(K.F0),W.Y36(K.gz),W.Y36(W.sBO),W.Y36(be.uw))},e.\u0275cmp=W.Xpm({type:e,selectors:[["ng-component"]],viewQuery:function(e,t){var n;(1&e&&W.Gf(qe,5),2&e)&&(W.iGM(n=W.CRH())&&(t.myScrollContainer=n.first))},hostBindings:function(e,t){1&e&&W.NdJ("focus",function(e){return t.onWindowFocus(e)},!1,W.Jf7)},decls:2,vars:2,consts:function(){var e,t,n,i,o,a,Y,$,D,H,E,F,R,K,V,G,X,ee,te,ne,ie,oe,ae,se,ce,re,de,ge,le,fe,ue;return e="Back",t="Conversation with",n="Contract ",i=" Contacting support ",o=" Notifications ",a="Conversation with",Y=" System message ",$="Contract created",D="between",H="and",E="In the event of a dispute, the Arbitration will only have access to this conversation. " + "[\ufffd#17\ufffd\ufffd/#17\ufffd|\ufffd#18\ufffd\ufffd/#18\ufffd]" + " " + "[\ufffd#17\ufffd\ufffd/#17\ufffd|\ufffd#18\ufffd\ufffd/#18\ufffd]" + "The customer needs to replenish the contract so that the employee can start implementation. Enjoy your cooperation and productive work!",E=W.Zx4(E),F="The customer has confirmed the terms of the contract and has reserved the payment. ",R="The employee has confirmed the terms of the contract. ",K="The contract is confirmed by the parties and is available for execution. ",V="The contract has been completed, the funds have been transferred to the employee. ",G="The customer has sent a request to cancel the contract.",X="Employee " + "\ufffd#2\ufffd" + "rejected the request" + "\ufffd/#2\ufffd" + ".",ee="Employee " + "\ufffd#2\ufffd" + "accepted request" + "\ufffd/#2\ufffd" + " and contract was canceled, the funds were returned to the customer.",te="Employee must respond to the request before ",ne=", otherwise the contract will be automatically revoked.",ie="Accept",oe="Reject",ae="Employee sent a request for the successful completion of the contract.",se="Customer " + "\ufffd#2\ufffd" + "rejected request" + "\ufffd/#2\ufffd" + ".",ce="Customer " + "\ufffd#2\ufffd" + " accepted the request" + "\ufffd/#2\ufffd" + ", the contract was completed and employee received payment.",re="Customer must respond to the request before",de=", otherwise the contract will be accepted automatically.",ge="Accept",le="Reject",fe="Contract was rejected, the funds were returned to the customer. ",ue="A dispute is open at the request of one of the parties. " + "[\ufffd#2\ufffd\ufffd/#2\ufffd|\ufffd#3\ufffd\ufffd/#3\ufffd|\ufffd#4\ufffd\ufffd/#4\ufffd|\ufffd#5\ufffd\ufffd/#5\ufffd|\ufffd#6\ufffd\ufffd/#6\ufffd]" + "" + "[\ufffd#2\ufffd\ufffd/#2\ufffd|\ufffd#3\ufffd\ufffd/#3\ufffd|\ufffd#4\ufffd\ufffd/#4\ufffd|\ufffd#5\ufffd\ufffd/#5\ufffd|\ufffd#6\ufffd\ufffd/#6\ufffd]" + " Describe what the problem is and what solution you agree to. " + "[\ufffd#2\ufffd\ufffd/#2\ufffd|\ufffd#3\ufffd\ufffd/#3\ufffd|\ufffd#4\ufffd\ufffd/#4\ufffd|\ufffd#5\ufffd\ufffd/#5\ufffd|\ufffd#6\ufffd\ufffd/#6\ufffd]" + " We will get acquainted with the contract, time, materials in the conversation and make a partial or full refund / accrual of funds. " + "[\ufffd#2\ufffd\ufffd/#2\ufffd|\ufffd#3\ufffd\ufffd/#3\ufffd|\ufffd#4\ufffd\ufffd/#4\ufffd|\ufffd#5\ufffd\ufffd/#5\ufffd|\ufffd#6\ufffd\ufffd/#6\ufffd]" + "" + "[\ufffd#2\ufffd\ufffd/#2\ufffd|\ufffd#3\ufffd\ufffd/#3\ufffd|\ufffd#4\ufffd\ufffd/#4\ufffd|\ufffd#5\ufffd\ufffd/#5\ufffd|\ufffd#6\ufffd\ufffd/#6\ufffd]" + " Try to find a compromise and resolve the conflict yourself. The arbitration award is final and not subject to change. ",[["class","page",4,"ngIf"],["class","page-loader",4,"ngIf"],[1,"page"],[1,"title-block"],[4,"ngIf"],["class","h3",4,"ngIf"],["mat-raised-button","",3,"click"],e,[1,"dialog-open"],["id","messages_content",1,"messages",3,"ngClass"],["scrollMe",""],["class","send-message",4,"ngIf"],["class","h3 contract",4,"ngIf"],[1,"h3"],[1,"hed-title"],t,[3,"routerLink"],[1,"far","fa-circle",3,"ngClass"],[1,"h3","contract"],[2,"margin-right",".5rem","white-space","nowrap"],n,i,o,a,["class","message",3,"id","ngClass",4,"ngFor","ngForOf"],[1,"message",3,"id","ngClass"],[1,"avatar"],["alt","",3,"src","srcset"],[1,"body"],[1,"title"],[1,"username"],[1,"date"],[1,"mess",3,"innerHTML"],["class","attach",4,"ngIf"],[1,"attach"],[3,"href"],[1,"fas","fa-paperclip"],["src","https://maketime.online/img/sup_ava.png","alt",""],[1,"body",2,"min-height","75px"],Y,["class","mess system",4,"ngIf"],["class","mess system",3,"innerHTML",4,"ngIf"],[1,"mess","system"],$,D,H,E,F,R,K,V,G,["class","controls",4,"ngIf"],X,[1,"bold"],ee,te,ne,[1,"controls"],["mat-raised-button","","color","primary",3,"click"],ie,oe,ae,se,ce,re,de,ge,le,fe,ue=W.Zx4(ue),[1,"mess","system",3,"innerHTML"]," Support ",["src","https://maketime.online/img/arbitrage_ava.svg","alt",""]," Arbitration ",[1,"send-message"],[2,"flex-grow","1"],["set","emojione","emoji","point_up",3,"darkMode","i18n","showPreview","style","isNative","emojiClick",4,"ngIf"],["action","",3,"submit"],["matInput","","placeholder","Enter message","id","messageText","maxlength","2000","matTextareaAutosize","true",3,"ngModelOptions","ngModel","ngModelChange"],["matSuffix","",1,"send-mess-i"],[1,"far","fa-smile","a-icon",3,"click"],[1,"fas","fa-paperclip","a-icon",3,"click"],["class","fas fa-briefcase a-icon",3,"click",4,"ngIf"],["hidden","","type","file","id","file",3,"change"],["fileInput",""],["class","upload-filename",4,"ngIf"],[1,"send-btn-block"],["mat-raised-button","","color","warn",1,"send-btn-raised",3,"disabled","click"],["class","loadingio-spinner-eclipse-isl35v8mq69",4,"ngIf"],["mat-fab","","color","warn",1,"send-btn-fab",3,"disabled","click"],["set","emojione","emoji","point_up",3,"darkMode","i18n","showPreview","isNative","emojiClick"],[1,"fas","fa-briefcase","a-icon",3,"click"],[1,"upload-filename"],[1,"fas","fa-times","a-icon",3,"click"],"Send",[1,"loadingio-spinner-eclipse-isl35v8mq69"],[1,"ldio-gs8jqvil8t5"],[1,"fas","fa-paper-plane"],[1,"page-loader"],["color","warn","mode","indeterminate"]]},template:function(e,t){1&e&&(W.YNc(0,qt,12,7,"div",0),W.YNc(1,Tt,2,0,"div",1)),2&e&&(W.Q6J("ngIf",t.dialog||t.user),W.xp6(1),W.Q6J("ngIf",!t.dialog&&!t.user))},directives:[F.O5,Ze.lW,F.mk,K.yS,F.sg,R._Y,R.JL,R.F,Ae.KE,ke.Nt,ke.D7,R.Fj,R.nD,R.JJ,R.On,Ae.R9,ye.qP,X.Ou],pipes:[ee.A],styles:[".h3[_ngcontent-%COMP%]{margin:1rem}.h3[_ngcontent-%COMP%], .title-block[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.title-block[_ngcontent-%COMP%]{align-items:center;border-bottom:1px solid var(--hr-color);padding-bottom:.5rem}.title-block[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;text-align:left}.dialog-open[_ngcontent-%COMP%]{justify-content:space-between}.dialog-open[_ngcontent-%COMP%], .page[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-grow:1}.message[_ngcontent-%COMP%]{display:flex;padding:.5rem 1rem .5rem 0}.avatar[_ngcontent-%COMP%]{width:75px;height:75px;border-radius:15px;margin-right:1rem}.avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:10px}.body[_ngcontent-%COMP%]{width:100%}.title[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.title[_ngcontent-%COMP%]   .username[_ngcontent-%COMP%]{font-size:1rem;display:flex;align-items:center;font-size:14px;font-weight:600;text-align:left}.title[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{color:rgba(0,0,0,.54);font-size:.8rem}.mess[_ngcontent-%COMP%]{text-align:left;font-size:.9rem;margin-top:.5rem;white-space:pre-wrap;word-break:break-word}.send-message[_ngcontent-%COMP%]{display:flex;border-top:1px solid var(--hr-color);padding-top:1rem;min-height:81px}.send-message[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.send-btn-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1rem;padding:.2rem 2rem;margin-left:2rem}.send-mess-i[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;margin-left:.5rem}.message[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.messages[_ngcontent-%COMP%]{max-height:calc(100vh - 295px);overflow-y:auto}.messages.full[_ngcontent-%COMP%]{max-height:calc(100vh - 305px)}.message.not_read[_ngcontent-%COMP%]{background-color:#74b9ff14}.message[_ngcontent-%COMP%]   .attach[_ngcontent-%COMP%]{font-size:.8rem;text-align:left;margin-top:1rem}@-webkit-keyframes ldio-gs8jqvil8t5{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(1turn)}}@keyframes ldio-gs8jqvil8t5{0%{transform:rotate(0deg)}50%{transform:rotate(180deg)}to{transform:rotate(1turn)}}.ldio-gs8jqvil8t5[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{position:absolute;-webkit-animation:ldio-gs8jqvil8t5 1s linear infinite;animation:ldio-gs8jqvil8t5 1s linear infinite;width:76px;height:76px;top:12px;left:12px;border-radius:50%;box-shadow:0 5px 0 0 #f44335;transform-origin:38px 39px}.loadingio-spinner-eclipse-isl35v8mq69[_ngcontent-%COMP%]{width:40px;height:40px;display:inline-block;overflow:hidden;background:none}.ldio-gs8jqvil8t5[_ngcontent-%COMP%]{width:100%;height:100%;position:relative;transform:translateZ(0) scale(.4);-webkit-backface-visibility:hidden;backface-visibility:hidden;transform-origin:0 0}.ldio-gs8jqvil8t5[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{box-sizing:content-box}.fa-times[_ngcontent-%COMP%]{margin-left:.5rem}.upload-filename[_ngcontent-%COMP%]{text-align:left;font-size:.8rem}.send-btn-raised[_ngcontent-%COMP%]{width:150px;height:45px}  .emoji-mart-search{display:none}@media only screen and (max-width:620px){.title-block[_ngcontent-%COMP%]   .h3[_ngcontent-%COMP%]{font-size:1.1rem}}@media only screen and (max-width:500px){.title-block[_ngcontent-%COMP%]   .h3.contract[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}}  .dialog-open .mess.system a{font-weight:700}.mess.system[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{text-align:center;margin-top:.5rem}.mess.system[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:not(:last-child){margin-right:1rem}.hed-title[_ngcontent-%COMP%]{margin-right:.5rem;white-space:nowrap}.send-btn-fab[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:30px!important;display:none}  .dialog-open .mat-form-field-infix{width:100%}@media only screen and (max-width:570px){.mob[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{display:none}.mob[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{display:inline}.send-btn-raised[_ngcontent-%COMP%], emoji-mart[_ngcontent-%COMP%]{display:none}.send-btn-fab[_ngcontent-%COMP%]{display:flex!important}.hed-title[_ngcontent-%COMP%]{display:none}}@media(max-width:350px){.send-btn-block[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:1rem;padding:0}.send-btn-fab[_ngcontent-%COMP%]{font-size:18px!important;width:40px;height:40px}.send-btn-block[_ngcontent-%COMP%]{margin-top:12px}}"]}),e}(),wt=[{path:"",component:pe},{path:"user/:user_id",component:Mt},{path:":dialog_id",component:Mt}],Pt=function(){var e=function e(){Y(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=W.oAB({type:e}),e.\u0275inj=W.cJS({imports:[[K.Bz.forChild(wt)],K.Bz]}),e}(),Ot=E(8091),St=((Ct=function e(){Y(this,e)}).\u0275fac=function(e){return new(e||Ct)},Ct.\u0275mod=W.oAB({type:Ct}),Ct.\u0275inj=W.cJS({imports:[[R.u5,F.ez,Pt,Ze.ot,ke.c,X.Cq,G.g,ye.bd,Ot.m]]}),Ct)}}])}();