!function(){var e,t,n,o,a,i,c,r,s,g,l,u,m,d,f,h,b,_;function p(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(self.webpackChunkangular_newtab=self.webpackChunkangular_newtab||[]).push([[300],{28300:function(C,x,Z){"use strict";Z.r(x),Z.d(x,{SettingsModule:function(){return le}});var w=Z(55109),q=Z(36278),S=Z(67563),P=Z(4391),y=Z(40485),M=Z(42304),O=Z(33960),T=Z(94253),A=Z(88269),F=Z(8723),J=Z(54342),I=Z(82758),z=Z(19014),D=Z(90095),N=Z(53909),Q=Z(63566),Y=Z(48318),B=Z(65901),E=Z(28383);function $(e,t){if(1&e){var n=M.EpF();M.TgZ(0,"div",26),M._UZ(1,"i",27),M.TgZ(2,"span"),M.SDv(3,28),M.qZA(),M.TgZ(4,"button",29),M.NdJ("click",function(){return M.CHM(n),M.oxw(2).messagingService.requestPerm()}),M.SDv(5,30),M.qZA(),M.qZA()}}function U(e,t){1&e&&(M.TgZ(0,"mat-error"),M.SDv(1,31),M.qZA())}function H(e,t){1&e&&(M.TgZ(0,"span"),M.SDv(1,39),M.qZA())}function R(e,t){1&e&&(M.TgZ(0,"span"),M._uU(1,"Google"),M.qZA())}function L(e,t){1&e&&M._UZ(0,"i",40)}function j(e,t){1&e&&(M.TgZ(0,"span"),M.SDv(1,41),M.qZA())}function V(e,t){1&e&&(M.TgZ(0,"span"),M._uU(1,"Facebook"),M.qZA())}function G(e,t){1&e&&M._UZ(0,"i",40)}var K=function(e){return{google_synced:e}},X=function(e){return{fb_synced:e}};function W(e,t){if(1&e){var n=M.EpF();M.TgZ(0,"div",32),M.TgZ(1,"h3"),M.SDv(2,33),M.qZA(),M.TgZ(3,"div",34),M.TgZ(4,"button",35),M.NdJ("click",function(){return M.CHM(n),M.oxw(2).oauthAction(1)}),M._UZ(5,"i",36),M.YNc(6,H,2,0,"span",0),M.YNc(7,R,2,0,"span",0),M.YNc(8,L,1,0,"i",37),M.qZA(),M.TgZ(9,"button",35),M.NdJ("click",function(){return M.CHM(n),M.oxw(2).oauthAction(2)}),M._UZ(10,"i",38),M.YNc(11,j,2,0,"span",0),M.YNc(12,V,2,0,"span",0),M.YNc(13,G,1,0,"i",37),M.qZA(),M.qZA(),M.qZA()}if(2&e){var o=M.oxw(2);M.xp6(4),M.Q6J("ngClass",M.VKq(8,K,o.settings.is_google_oauth)),M.xp6(2),M.Q6J("ngIf",!o.settings.is_google_oauth),M.xp6(1),M.Q6J("ngIf",o.settings.is_google_oauth),M.xp6(1),M.Q6J("ngIf",o.settings.is_google_oauth),M.xp6(1),M.Q6J("ngClass",M.VKq(10,X,o.settings.is_fb_oauth)),M.xp6(2),M.Q6J("ngIf",!o.settings.is_fb_oauth),M.xp6(1),M.Q6J("ngIf",o.settings.is_fb_oauth),M.xp6(1),M.Q6J("ngIf",o.settings.is_fb_oauth)}}function ee(e,t){if(1&e){var n=M.EpF();M.TgZ(0,"mat-checkbox",15),M.NdJ("click",function(e){return M.CHM(n),M.oxw(2).changeShowBookmarks(e)}),M.SDv(1,42),M.qZA()}if(2&e){var o=M.oxw(2);M.Q6J("checked",o.is_bookmarks_enabled)}}function te(e,t){if(1&e){var n=M.EpF();M.ynx(0),M.TgZ(1,"div",1),M.TgZ(2,"h2"),M.SDv(3,2),M.qZA(),M.qZA(),M.YNc(4,$,6,0,"div",3),M.TgZ(5,"div",4),M.TgZ(6,"h3"),M.SDv(7,5),M.qZA(),M.TgZ(8,"form",6),M.NdJ("submit",function(){return M.CHM(n),M.oxw().authChangeFormSubmit()}),M.TgZ(9,"mat-form-field",7),M.TgZ(10,"mat-label"),M._uU(11,"Email"),M.qZA(),M._UZ(12,"input",8),M.YNc(13,U,2,0,"mat-error",0),M.qZA(),M.TgZ(14,"mat-form-field",7),M.TgZ(15,"mat-label"),M.SDv(16,9),M.qZA(),M._UZ(17,"input",10),M.qZA(),M.TgZ(18,"div"),M.TgZ(19,"button",11),M.SDv(20,12),M.qZA(),M.qZA(),M.qZA(),M.YNc(21,W,14,12,"div",13),M.TgZ(22,"div"),M.TgZ(23,"h3"),M.SDv(24,14),M.qZA(),M.TgZ(25,"div"),M.TgZ(26,"mat-checkbox",15),M.NdJ("click",function(){return M.CHM(n),M.oxw().changeEnableSound()}),M.SDv(27,16),M.qZA(),M.qZA(),M.TgZ(28,"div"),M.TgZ(29,"mat-checkbox",15),M.NdJ("click",function(){return M.CHM(n),M.oxw().changeHideFarm()}),M.SDv(30,17),M.qZA(),M.qZA(),M.TgZ(31,"div"),M.YNc(32,ee,2,1,"mat-checkbox",18),M.qZA(),M.TgZ(33,"div",19),M.TgZ(34,"mat-form-field"),M.TgZ(35,"mat-label"),M.SDv(36,20),M.qZA(),M.TgZ(37,"mat-select",21),M.NdJ("selectionChange",function(e){return M.CHM(n),M.oxw().changeLanguage(e)})("ngModelChange",function(e){return M.CHM(n),M.oxw().selectedLanguage=e}),M.TgZ(38,"mat-option",22),M.SDv(39,23),M.qZA(),M.TgZ(40,"mat-option",24),M.SDv(41,25),M.qZA(),M.qZA(),M.qZA(),M.qZA(),M.qZA(),M.qZA(),M.BQk()}if(2&e){var o=M.oxw();M.xp6(4),M.Q6J("ngIf",!o.commonService.fcm_enable&&!o.commonService.is_mobile),M.xp6(4),M.Q6J("formGroup",o.authChangeForm),M.xp6(5),M.Q6J("ngIf",o.error_email_exist),M.xp6(6),M.Q6J("disabled",!o.authChangeForm.get("email").value||o.authChangeForm.get("email").invalid),M.xp6(2),M.Q6J("ngIf",!o.commonService.is_mobile),M.xp6(5),M.Q6J("checked",o.commonService.timer_status.enable_sound),M.xp6(3),M.Q6J("checked",1==o.settings.hide_farm),M.xp6(3),M.Q6J("ngIf",o.commonService.isChromeExtension()),M.xp6(5),M.Q6J("ngModel",o.selectedLanguage)}}function ne(e,t){1&e&&(M.ynx(0),M.TgZ(1,"div",43),M._UZ(2,"mat-progress-spinner",44),M.qZA(),M.BQk())}var oe,ae,ie=[{path:"",component:(oe=function(){function e(t,n,o,a,i,c,r,s,g){var l=this;v(this,e),this.commonService=t,this.dialog=n,this.cdr=o,this._formBuilder=a,this.route=i,this.location=c,this._snackBar=r,this.messagingService=s,this.authService=g,this.is_loading=!0,this.rubErrors={invalid:{card:!1,yandex:!1,qiwi:!1}},this.uahErrors={invalid:{card:!1}},this.authChangeForm=this._formBuilder.group({email:["",[q.kI.email,q.kI.required]],password:["",[q.kI.minLength(4),q.kI.maxLength(12)]]}),this.rubChangeForm=this._formBuilder.group({card:[""],yandex:[""],qiwi:[""]}),this.uahChangeForm=this._formBuilder.group({card:[""]}),this.getSettings(),this.route.queryParams.subscribe(function(e){e.confirm_token&&l.commonService.createRequest("post","settings/confirm-settings",{confirm_token:e.confirm_token}).toPromise().then(function(e){e&&(e.token_not_found&&l._snackBar.open(y.error_confirm_not_found,null,{verticalPosition:"top",duration:5e3}),"success"==e.status&&(l._snackBar.open(y.email_changed,null,{verticalPosition:"top",duration:5e3}),l.authChangeForm.get("email").setValue(e.email),l.cdr.detectChanges())),l.location.replaceState("/settings")})});var u=window.location.href;this.selectedLanguage=u.match("/ru/index.html")?"ru":"en",this.is_bookmarks_enabled="1"==localStorage.getItem("is_bookmarks_enabled")}var t,n,o;return t=e,(n=[{key:"oauthAction",value:function(e){var t=this,n=1==e?this.settings.is_google_oauth:this.settings.is_fb_oauth;n?this.openDialog("unset_account",{soc_type:e}):this.commonService.createRequest("get","oauth-action/"+n.toString()+"/set",{}).toPromise().then(function(n){if(n.temp_token)var o=window.open("https://maketime.online/web/oauth_go?type="+e.toString()+"&temp_token="+n.temp_token,"_blank","width=640, height=480"),a=t,i=setInterval(function(){o.closed&&(clearInterval(i),a.getSettings())},500);else t.getSettings()})}},{key:"getSettings",value:function(){var e=this;this.commonService.createRequest("get","settings",{}).toPromise().then(function(t){t&&(e.settings=t,e.authChangeForm.get("email").setValue(e.settings.email),e.rubChangeForm.get("card").setValue(e.settings.rub.card),e.rubChangeForm.get("yandex").setValue(e.settings.rub.yandex),e.rubChangeForm.get("qiwi").setValue(e.settings.rub.qiwi),e.uahChangeForm.get("card").setValue(e.settings.uah.card),e.is_loading&&(e.is_loading=!1),t.change_token&&e.openDialog("change_account"),e.cdr.destroyed||e.cdr.detectChanges())})}},{key:"openDialog",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;switch(e){case"change_account":this.dialog.open(P.a,{data:{type:"change_account"}}).afterClosed().subscribe(function(e){var n="";e&&(n=e.action),t.commonService.createRequest("post","settings/change-token",{action:n}).toPromise().then(function(){switch(n){case"stay":1==t.settings.change_token.social_type?t.settings.is_google_oauth=!0:t.settings.is_fb_oauth=!0,t.settings.change_token=null;break;case"go":t.authService.setToken(t.settings.change_token.token),location.reload()}t.cdr.detectChanges()})});break;case"unset_account":this.dialog.open(P.a,{data:{type:"unset_account"}}).afterClosed().subscribe(function(e){e&&t.commonService.createRequest("get","oauth-action/"+n.soc_type.toString()+"/unset",{}).toPromise().then(function(e){1==n.soc_type&&(t.settings.is_google_oauth=!1),2==n.soc_type&&(t.settings.is_fb_oauth=!1),t.cdr.detectChanges()})});break;case"enable_bookmarks":this.dialog.open(P.a,{data:{type:"enable_bookmarks"}}).afterClosed().subscribe(function(e){e?chrome.permissions.request({permissions:["bookmarks"]},function(e){e?(localStorage.setItem("is_bookmarks_enabled","1"),t.is_bookmarks_enabled=!0):t.is_bookmarks_enabled=!1,t.cdr.detectChanges()}):(t.is_bookmarks_enabled=!1,t.cdr.detectChanges())})}}},{key:"changeEnableSound",value:function(){var e=this;return this.checkFCMToken(!this.commonService.timer_status.enable_sound).then(function(t){var n=e.commonService.timer_status.enable_sound?"unset":"set";e.commonService.createRequest("post","settings/change-sound",{action:n}).toPromise().then(function(){e.commonService.timer_status.enable_sound="unset"!=n,e.cdr.detectChanges()})})}},{key:"checkFCMToken",value:function(e){var t=this;return this.commonService.fcm_enable?Promise.resolve(!0):e?this.messagingService.checkPermission().then(function(e){return e?Promise.resolve(!0):t.dialog.open(P.a,{data:{type:"request_push"},autoFocus:!1}).afterClosed().subscribe(function(e){return e?t.messagingService.requestPerm():Promise.resolve(!1)})}).catch(function(){return Promise.resolve(!1)}):Promise.resolve(!1)}},{key:"changeHideFarm",value:function(){var e=this,t=this.settings.hide_farm?"unset":"set";this.commonService.createRequest("post","settings/change-hide-farm",{action:t}).toPromise().then(function(){e.settings.hide_farm="unset"!=t,e.cdr.detectChanges()})}},{key:"authChangeFormSubmit",value:function(){var e=this;this.authChangeForm.valid&&(this.error_email_exist=!1,this.commonService.createRequest("post","settings/change-auth",{email:this.authChangeForm.get("email").value,password:this.authChangeForm.get("password").value}).toPromise().then(function(t){if(t&&"email_exist"==t.error&&(e.error_email_exist=!0,e.authChangeForm.controls.email.setErrors({incorrect:!0})),t&&("send_confirm"==t.change_email||"success"==t.change_password)){var n="";"success"==t.change_password&&(n=y.password_changed),"send_confirm"==t.change_email&&(n=y.sended_mail_for_confirm_email),n&&e._snackBar.open(n,null,{verticalPosition:"top",duration:5e3})}e.cdr.detectChanges()}))}},{key:"rubChangeFormSubmit",value:function(){var e=this;this.rubChangeForm.valid&&this.commonService.createRequest("post","settings/change-wallets",{action:"RUB",card:this.rubChangeForm.get("card").value,yandex:this.rubChangeForm.get("yandex").value,qiwi:this.rubChangeForm.get("qiwi").value}).toPromise().then(function(t){t.invalid&&(e.rubErrors.invalid=t.invalid,t.invalid.card&&e.rubChangeForm.controls.card.setErrors({incorrect:!0}),t.invalid.yandex&&e.rubChangeForm.controls.yandex.setErrors({incorrect:!0}),t.invalid.qiwi&&e.rubChangeForm.controls.qiwi.setErrors({incorrect:!0})),t.change_data&&e._snackBar.open(y.data_changed,null,{verticalPosition:"top",duration:5e3}),e.cdr.detectChanges()})}},{key:"uahChangeFormSubmit",value:function(){var e=this;this.uahChangeForm.valid&&this.commonService.createRequest("post","settings/change-wallets",{action:"UAH",card:this.uahChangeForm.get("card").value}).toPromise().then(function(t){t.invalid&&(e.uahErrors.invalid=t.invalid,t.invalid.card&&e.uahChangeForm.controls.card.setErrors({incorrect:!0})),t.change_data&&e._snackBar.open(y.data_changed,null,{verticalPosition:"top",duration:5e3}),e.cdr.detectChanges()})}},{key:"changeLanguage",value:function(e){var t=e.value;if(-1!=["ru","en"].indexOf(t)){localStorage.setItem("selectedLanguage",t);var n=window.location.href.replace(/(?:ru|en)\/index/gi,t+"/index");window.location.href=n}}},{key:"changeShowBookmarks",value:function(e){var t=this;if(e.preventDefault(),this.is_bookmarks_enabled)return localStorage.setItem("is_bookmarks_enabled","0"),void(this.is_bookmarks_enabled=!1);chrome.permissions.contains({permissions:["bookmarks"]},function(e){if(!e)return t.openDialog("enable_bookmarks");localStorage.setItem("is_bookmarks_enabled","1"),t.is_bookmarks_enabled=!0,t.cdr.detectChanges()})}}])&&k(t.prototype,n),o&&k(t,o),e}(),oe.\u0275fac=function(e){return new(e||oe)(M.Y36(O.v),M.Y36(T.uw),M.Y36(M.sBO),M.Y36(q.qu),M.Y36(S.gz),M.Y36(w.Ye),M.Y36(A.ux),M.Y36(F.o),M.Y36(J.e))},oe.\u0275cmp=M.Xpm({type:oe,selectors:[["ng-component"]],decls:2,vars:2,consts:function(){return[[4,"ngIf"],[1,"title",2,"text-align","left"],"Settings",["class","warn-title",4,"ngIf"],[2,"text-align","left","margin","2rem 1rem"],"Access",[1,"example-form",2,"display","flex","flex-direction","column",3,"formGroup","submit"],[1,"example-full-width"],["matInput","","formControlName","email"],"New password",["matInput","","formControlName","password","type","password","maxlength","12","autocomplete","false"],["mat-raised-button","","type","submit",3,"disabled"],"Save",["class","block-sync",4,"ngIf"],"Other",[3,"checked","click"],"Show push notification at the end of timer","Exclude farm users from rating",[3,"checked","click",4,"ngIf"],[2,"margin-top","2rem"],"Language",[3,"ngModel","selectionChange","ngModelChange"],["value","en"],"English",["value","ru"],"Russian",[1,"warn-title"],[1,"fas","fa-exclamation-triangle"],"Enable notifications",["mat-raised-button","","color","primary","matTooltip","If you have previously denied access, you need to go to the browser settings and activate notifications manually","matTooltipPosition","above","matTooltipShowDelay","1500",3,"click"],"Activate","This email belongs to another user.",[1,"block-sync"],"Linked accounts",[1,"buttons"],["mat-raised-button","",3,"ngClass","click"],[1,"fab","fa-google"],["class","fas fa-check","style","position: absolute;\n                right: 15px;\n                top: 11px;\n                color: #00d400;",4,"ngIf"],[1,"fab","fa-facebook-square"],"Link Google",[1,"fas","fa-check",2,"position","absolute","right","15px","top","11px","color","#00d400"],"Link Facebook","Show bookmarks bar in new tab",[1,"page-loader"],["color","warn","mode","indeterminate"]]},template:function(e,t){1&e&&(M.YNc(0,te,42,9,"ng-container",0),M.YNc(1,ne,3,0,"ng-container",0)),2&e&&(M.Q6J("ngIf",!t.is_loading),M.xp6(1),M.Q6J("ngIf",t.is_loading))},directives:[w.O5,q._Y,q.JL,q.sg,I.KE,I.hX,z.Nt,q.Fj,q.JJ,q.u,q.nD,D.lW,N.oG,Q.gD,q.On,Y.ey,B.gM,I.TO,w.mk,E.Ou],styles:["mat-form-field[_ngcontent-%COMP%]{width:300px}.block[_ngcontent-%COMP%]{display:block;max-width:500px;margin:0 auto;text-align:left}.block-sync[_ngcontent-%COMP%]{margin:4rem 0}.block-sync[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:1.1rem;text-align:left;width:100%;display:block;margin-bottom:10px}.block-sync[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:210px;text-align:left;margin:10px}.fa-facebook-square[_ngcontent-%COMP%], .fa-google[_ngcontent-%COMP%]{margin-right:10px}.fa-google[_ngcontent-%COMP%]{color:#4285f4}.fa-facebook-square[_ngcontent-%COMP%]{color:#4267b2}.sound-conf[_ngcontent-%COMP%]{margin-top:3rem;font-size:1rem}.feedback[_ngcontent-%COMP%]{margin-top:2rem}.feedback[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.feedback[_ngcontent-%COMP%]   .send[_ngcontent-%COMP%]{text-align:left}.fb_synced[_ngcontent-%COMP%]{color:#fff;background-color:#4267b2}.fb_synced[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}.google_synced[_ngcontent-%COMP%]{color:#fff;background-color:#4285f4}.google_synced[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff}.telegram-block[_ngcontent-%COMP%]{margin-top:2rem;font-size:1rem}.telegram-block[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:10px;font-weight:700;white-space:nowrap}.telegram-block[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:25px;position:relative;top:6px;margin-right:2px}.version[_ngcontent-%COMP%]{font-size:12px;margin-top:2rem;text-align:center}  share-buttons .sb-group{justify-content:center}  share-buttons :not(share-button) div.sb-button{display:none}mat-checkbox[_ngcontent-%COMP%]     .mat-checkbox-layout{white-space:normal}.pro-status[_ngcontent-%COMP%]{text-align:left;margin:3rem 1rem;line-height:24px}.pro-status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{font-weight:700}.pro-status[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:2rem;font-weight:700}.warn-title[_ngcontent-%COMP%]{text-align:left;font-size:18px;margin:2rem 0 0 1rem;color:#3f51b5}.warn-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}.warn-title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:2rem}"]}),oe)}],ce=function(){var e=function e(){v(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=M.oAB({type:e}),e.\u0275inj=M.cJS({imports:[[S.Bz.forChild(ie)],S.Bz]}),e}(),re=Z(25699),se=Z(87221),ge=Z(8091),le=((ae=function e(){v(this,e)}).\u0275fac=function(e){return new(e||ae)},ae.\u0275mod=M.oAB({type:ae}),ae.\u0275inj=M.cJS({imports:[[q.u5,q.UX,w.ez,ce,D.ot,re.Nh,q.u5,z.c,se.QW,E.Cq,N.p9,ge.m]]}),ae)}}])}();